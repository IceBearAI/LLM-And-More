import{d as M,ac as W,x as D,r as k,c as H,U as V,k as y,l as F,m as a,W as d,j as e,_ as m,Z as $,a5 as z,n as w,F as L,av as R,al as J,am as O,o as Z,S as X,aA as ee,Q as ae,$ as x,aB as le}from"./utils-01c411e4.js";import{_ as te}from"./BaseBreadcrumb.vue_vue_type_style_index_0_lang-51ed0b2c.js";import{_ as oe}from"./UiParentCard.vue_vue_type_script_setup_true_lang-76206b3a.js";import{A as se}from"./AlertBlock-fafdffe4.js";import{_ as re}from"./ConfirmByInput.vue_vue_type_style_index_0_lang-d347f42d.js";import{_ as ne}from"./AiAudio.vue_vue_type_style_index_0_lang-70bb293f.js";import{_ as de}from"./Explain.vue_vue_type_style_index_0_lang-c016eb46.js";import{_ as ue}from"./UploadFile.vue_vue_type_script_setup_true_lang-187fe0ae.js";import{a5 as A,ae as ie,af as pe,J as me,M as ce,_ as _e,V as fe}from"./index-bb5b6a82.js";import{V as ve,a as ke}from"./VRadioGroup-50dd96e8.js";import{V as be}from"./VAlert-29b6aa02.js";import{V as ge}from"./VSwitch-0d2f9673.js";import{V as Ve}from"./VTextarea-4511848c.js";import{V as he}from"./VForm-d3cbc9ba.js";import{V as ye}from"./VRow-970d1eb0.js";import{V as S}from"./VCol-a8d2bf92.js";import"./IconInfoCircle-18798ea0.js";import"./Confirm-e9511438.js";import"./VFileInput-e0a13545.js";const f=C=>(J("data-v-184fa553"),C=C(),O(),C),xe={class:"mx-auto mt-3",style:{width:"540px"}},Se={class:"required"},Ce=f(()=>d("label",{class:"required"},"标识",-1)),Ie=f(()=>d("label",{class:"required"},"姓名",-1)),we=f(()=>d("label",{class:"required"},"性别",-1)),De=f(()=>d("label",{class:"required"},"年龄段",-1)),Ue=f(()=>d("label",{class:"required"},"语言",-1)),Te=f(()=>d("label",{class:"required"},"风格",-1)),Fe=f(()=>d("label",{class:"required"},"适应范围",-1)),Ne=f(()=>d("label",null,"头像",-1)),Pe=f(()=>d("label",{class:"required"},"启用",-1)),qe=f(()=>d("label",null,"备注",-1)),Be=M({__name:"CreateSpeakerPane",emits:["submit"],setup(C,{expose:N,emit:I}){const U={provider:null,speakName:"",speakCname:"",gender:1,ageGroup:null,lang:null,speakStyle:null,area:null,headImgFileId:"",enabled:!1,remark:""},P=I,h=W().options.speak_gender,g=D({operateType:"add"}),t=k({...U}),i=k(null),v=k(),T=k(),p=D({provider:[n=>!!n||"请选择供应商"],speakName:[n=>!!n||"请输入标识"],speakCname:[n=>!!n||"请输入姓名"],ageGroup:[n=>!!n||"请选择年龄段"],lang:[n=>!!n||"请选择语言"],speakStyle:[n=>!!n||"请选择风格"],area:[n=>!!n||"请选择适应范围"]}),c=H(()=>g.operateType==="edit"),q=()=>{t.value.headImgFileId="",i.value=null},B=async({valid:n,showLoading:o})=>{if(n){const s={url:"",method:""};g.operateType=="add"?(s.url="/voice/speak",s.method="post"):(s.url=`/voice/speak/${t.value.id}`,s.method="put");const[u,l]=await R[s.method]({showLoading:o,showSuccess:!0,url:s.url,data:t.value});l&&(v.value.hide(),P("submit"))}};return N({show({title:n,operateType:o,infos:s}){v.value.show({title:n,refForm:T}),g.operateType=o,g.operateType==="add"?(t.value={...U},i.value=null):(t.value={...s},i.value={s3Url:s.headImg})}}),(n,o)=>{const s=V("Select"),u=V("Pane");return y(),F(u,{ref_key:"refPane",ref:v,onSubmit:B},{default:a(()=>[d("div",xe,[e(he,{ref_key:"refForm",ref:T,class:"my-form"},{default:a(()=>[e(s,{placeholder:"请选择供应商",rules:p.provider,mapDictionary:{code:"speak_provider"},modelValue:t.value.provider,"onUpdate:modelValue":o[0]||(o[0]=l=>t.value.provider=l),disabled:c.value},{prepend:a(()=>[d("label",Se,[m("供应 "),e(de,null,{default:a(()=>[m("供应商指的是外部服务提供，自己有服务请选择Local")]),_:1})])]),_:1},8,["rules","modelValue","disabled"]),e(A,{type:"text",placeholder:"请输入标识","hide-details":"auto",clearable:"",rules:p.speakName,modelValue:t.value.speakName,"onUpdate:modelValue":o[1]||(o[1]=l=>t.value.speakName=l),disabled:c.value},{prepend:a(()=>[Ce]),_:1},8,["rules","modelValue","disabled"]),e(A,{type:"text",placeholder:"请输入姓名","hide-details":"auto",clearable:"",rules:p.speakCname,modelValue:t.value.speakCname,"onUpdate:modelValue":o[2]||(o[2]=l=>t.value.speakCname=l)},{prepend:a(()=>[Ie]),_:1},8,["rules","modelValue"]),e(ve,{"hide-details":"auto",modelValue:t.value.gender,"onUpdate:modelValue":o[3]||(o[3]=l=>t.value.gender=l),inline:"",disabled:c.value},{prepend:a(()=>[we]),default:a(()=>[(y(!0),$(L,null,z(w(h),l=>(y(),F(ke,{label:l.label,color:"primary",value:l.value},null,8,["label","value"]))),256))]),_:1},8,["modelValue","disabled"]),e(s,{placeholder:"请选择年龄段",rules:p.ageGroup,mapDictionary:{code:"speak_age_group"},modelValue:t.value.ageGroup,"onUpdate:modelValue":o[4]||(o[4]=l=>t.value.ageGroup=l)},{prepend:a(()=>[De]),_:1},8,["rules","modelValue"]),e(s,{placeholder:"请选择语言",rules:p.lang,mapDictionary:{code:"speak_lang"},modelValue:t.value.lang,"onUpdate:modelValue":o[5]||(o[5]=l=>t.value.lang=l),disabled:c.value},{prepend:a(()=>[Ue]),_:1},8,["rules","modelValue","disabled"]),e(s,{placeholder:"请选择风格",rules:p.speakStyle,mapDictionary:{code:"speak_style"},modelValue:t.value.speakStyle,"onUpdate:modelValue":o[6]||(o[6]=l=>t.value.speakStyle=l)},{prepend:a(()=>[Te]),_:1},8,["rules","modelValue"]),e(s,{placeholder:"请选择适应范围",rules:p.area,mapDictionary:{code:"speak_area"},modelValue:t.value.area,"onUpdate:modelValue":o[7]||(o[7]=l=>t.value.area=l)},{prepend:a(()=>[Fe]),_:1},8,["rules","modelValue"]),e(ie,{"hide-details":"auto"},{prepend:a(()=>[Ne]),default:a(()=>[i.value&&i.value.s3Url?(y(),F(be,{key:0,color:"borderColor",variant:"outlined",density:"compact"},{close:a(()=>[e(pe,{class:"text-24 opacity-50 cursor-pointer",color:"textPrimary",onClick:q},{default:a(()=>[m("mdi-close-circle")]),_:1})]),default:a(()=>[e(me,{size:"60"},{default:a(()=>[e(ce,{transition:!1,src:i.value.s3Url,alt:"上传成功后的头像",cover:""},null,8,["src"])]),_:1})]),_:1})):(y(),F(ue,{key:1,accept:"image/*",modelValue:t.value.headImgFileId,"onUpdate:modelValue":o[8]||(o[8]=l=>t.value.headImgFileId=l),infos:i.value,"onUpdate:infos":o[9]||(o[9]=l=>i.value=l),"prepend-icon":null,"prepend-inner-icon":"mdi-camera"},null,8,["modelValue","infos"]))]),_:1}),e(ge,{modelValue:t.value.enabled,"onUpdate:modelValue":o[10]||(o[10]=l=>t.value.enabled=l),color:"primary","hide-details":"auto"},{prepend:a(()=>[Pe]),_:1},8,["modelValue"]),e(Ve,{modelValue:t.value.remark,"onUpdate:modelValue":o[11]||(o[11]=l=>t.value.remark=l),modelModifiers:{trim:!0},placeholder:"请输入备注",clearable:""},{prepend:a(()=>[qe]),_:1},8,["modelValue"])]),_:1},512)])]),_:1},512)}}});const $e=_e(Be,[["__scopeId","data-v-184fa553"]]),Re={class:"text-primary font-weight-black"},Ae=d("br",null,null,-1),oa=M({__name:"speakerManage",setup(C){const{loadDictTree:N,getLabels:I}=W();N(["speak_age_group","speak_gender","speak_provider","speak_lang"]);const U=k({title:"发声人管理"}),P=k([{text:"声音合成",disabled:!1,href:"#"},{text:"发声人管理",disabled:!0,href:"#"}]),b=D({speakName:"",provider:null,lang:null}),h=D({list:[],total:0}),g=k(),t=k(),i=k(),v=D({id:"",name:""}),T=s=>{let u=[];return u.push({text:"删除",color:"error",click(){q(s)}}),u.push({text:"编辑",color:"info",click(){o(s)}}),u},p=async(s={})=>{const[u,l]=await R.get({url:"/voice/speak",showLoading:t.value.el,data:{...b,...s}});l?(h.list=l.list||[],h.total=l.total):(h.list=[],h.total=0)},c=()=>{t.value.query({page:1})},q=s=>{v.name=s.speakCname,v.id=s.id,i.value.show({width:"400px",confirmText:v.name})},B=async(s={})=>{const[u,l]=await R.delete({...s,showSuccess:!0,url:`/voice/speak/${v.id}`});l&&(i.value.hide(),p())},n=()=>{g.value.show({title:"添加发声人",operateType:"add"})},o=s=>{g.value.show({title:"编辑发声人",infos:s,operateType:"edit"})};return Z(()=>{p()}),(s,u)=>{const l=V("Select"),Q=V("ButtonsInForm"),_=V("el-table-column"),Y=V("router-link"),E=V("ButtonsInTable"),K=V("TableWithPager"),j=X("copy");return y(),$(L,null,[e(te,{title:U.value.title,breadcrumbs:P.value},null,8,["title","breadcrumbs"]),e(oe,null,{default:a(()=>[e(ye,null,{default:a(()=>[e(S,{cols:"12",lg:"3",md:"4",sm:"6"},{default:a(()=>[e(A,{modelValue:b.speakName,"onUpdate:modelValue":u[0]||(u[0]=r=>b.speakName=r),label:"请输入标识","hide-details":"",clearable:"",onKeyup:ee(c,["enter"]),"onClick:clear":c},null,8,["modelValue","onKeyup"])]),_:1}),e(S,{cols:"12",lg:"3",md:"4",sm:"6"},{default:a(()=>[e(l,{modelValue:b.provider,"onUpdate:modelValue":u[1]||(u[1]=r=>b.provider=r),mapDictionary:{code:"speak_provider"},label:"请选择供应商","hide-details":"",onChange:c},null,8,["modelValue"])]),_:1}),e(S,{cols:"12",lg:"3",md:"4",sm:"6"},{default:a(()=>[e(l,{modelValue:b.lang,"onUpdate:modelValue":u[2]||(u[2]=r=>b.lang=r),mapDictionary:{code:"speak_lang"},label:"请选择语言","hide-details":"",onChange:c},null,8,["modelValue"])]),_:1}),e(S,{cols:"12",lg:"3",md:"4",sm:"6"},{default:a(()=>[e(Q,null,{default:a(()=>[e(fe,{color:"primary",onClick:n},{default:a(()=>[m("添加发声人")]),_:1})]),_:1})]),_:1}),e(S,{cols:"12"},{default:a(()=>[e(se,null,{default:a(()=>[m("修改之后将实时生效，请谨慎操作！")]),_:1})]),_:1}),e(S,{cols:"12"},{default:a(()=>[e(K,{onQuery:p,ref_key:"tableWithPagerRef",ref:t,infos:h},{default:a(()=>[e(_,{label:"标识",width:"150px","show-overflow-tooltip":""},{default:a(({row:r})=>[ae((y(),$("span",null,[m(x(r.speakName),1)])),[[j,r.speakName]])]),_:1}),e(_,{label:"姓名",prop:"speakCname",width:"100px"}),e(_,{label:"供应",width:"100px"},{default:a(({row:r})=>[d("span",null,x(w(I)([["speak_provider",r.provider]])),1)]),_:1}),e(_,{label:"语言",width:"160px"},{default:a(({row:r})=>[d("span",null,x(w(I)([["speak_lang",r.lang]])),1)]),_:1}),e(_,{label:"音色",width:"120px"},{default:a(({row:r})=>[d("div",null,x(w(I)([["speak_age_group",r.ageGroup],["speak_gender",r.gender]],G=>G.length?G.join("")+"声":"未知")),1)]),_:1}),e(_,{label:"试听","min-width":"330px"},{default:a(({row:r})=>[e(ne,{src:r==null?void 0:r.speakDemo},null,8,["src"])]),_:1}),e(_,{label:"部署",width:"100px"},{default:a(({row:r})=>[e(Y,{to:{path:"/voice-print/synthesis/synthesis-voice",query:{provider:r.provider,lang:r.lang,speakName:r.speakName}},class:"text-info"},{default:a(()=>[m("合成")]),_:2},1032,["to"])]),_:1}),e(_,{label:"备注",prop:"remark","min-width":"200px"}),e(_,{label:"更新时间","min-width":"160px"},{default:a(({row:r})=>[m(x(w(le).dateFormat(r.updatedAt,"YYYY-MM-DD HH:mm:ss")),1)]),_:1}),e(_,{label:"操作",width:"120px",fixed:"right"},{default:a(({row:r})=>[e(E,{buttons:T(r)},null,8,["buttons"])]),_:1})]),_:1},8,["infos"])]),_:1})]),_:1})]),_:1}),e(re,{ref_key:"refConfirmDelete",ref:i,onSubmit:B},{text:a(()=>[m(" 您将要删除"),d("span",Re,x(v.name),1),m("发声人，删除之后该声音将无法继续合成新的声音。"),Ae,m(" 确定要继续吗？ ")]),_:1},512),e($e,{ref_key:"createSpeakerPaneRef",ref:g,onSubmit:c},null,512)],64)}}});export{oa as default};
