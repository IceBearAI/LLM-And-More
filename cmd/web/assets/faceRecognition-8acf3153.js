import{_ as E}from"./BaseBreadcrumb.vue_vue_type_style_index_0_lang-e4abdd62.js";import{_ as R}from"./UiParentCard.vue_vue_type_script_setup_true_lang-4369d2cd.js";import{C as A}from"./ChipBoolean-24ea80d3.js";import{d as L,x as C,r as h,c as Q,U as v,k as c,l as f,m as e,j as t,W as i,_ as r,Z as B,$ as u,F as M,Y as b,a1 as j,b9 as W,am as H,an as O,o as Z,n as G,bg as J}from"./utils-5f930323.js";import{_ as K}from"./Explain.vue_vue_type_style_index_0_lang-86bc965d.js";import{V}from"./VCol-f4c3210b.js";import{V as X}from"./VForm-5e264cc2.js";import{V as q}from"./VFileInput-5b0dbd33.js";import{L as N,a4 as ee,V as Y,ad as y,_ as te,I as D}from"./index-1ef416e3.js";import{V as ae}from"./VSlider-cbe6eeef.js";import{V as $}from"./VRow-3347130d.js";const p=k=>(H("data-v-bc6cae62"),k=k(),O(),k),le=p(()=>i("label",{class:"required"},"检测类型",-1)),oe=p(()=>i("label",{class:"required"},"检测图片",-1)),ne=p(()=>i("label",{class:"required"},"比对图片",-1)),se={class:"text-center",style:{width:"28px"}},re=p(()=>i("label",{class:"required"},"比对阈值",-1)),ie=p(()=>i("label",null,"检测vs比对：",-1)),de=p(()=>i("p",{class:"text-2xl"},"vs",-1)),ue=p(()=>i("label",null,"人脸边距：",-1)),ce=p(()=>i("label",null,"人脸个数：",-1)),pe=p(()=>i("label",null,"比对阈值：",-1)),me=p(()=>i("label",null,"相似比分：",-1)),_e=p(()=>i("label",null,"同一个人：",-1)),fe=L({__name:"CreateRecognitionPane",emits:["submit"],setup(k,{expose:U,emit:P}){const g=P,m=C({operateType:"add"}),x=h(),I=h(),l=C({checkType:null,checkImage:[],baseImage:[],tolerance:.6,faceMargin:""}),s=h({}),w=h(!1),S=Q(()=>{const d={checkImage:"",baseImage:""};return["checkImage","baseImage"].forEach(o=>{l[o]&&l[o].length>0&&(d[o]=URL.createObjectURL(l[o][0]))}),d}),_=async()=>{let{valid:d}=await I.value.validate();if(d){w.value=!0;const[o,n]=await W.upload({url:"/esrgan/face/recognition",data:l});n&&(s.value=n,g("submit")),w.value=!1}};return U({show({title:d,operateType:o,infos:n}){x.value.show({title:d,width:"1000px",hasSubmitBtn:!1}),m.operateType=o,m.operateType==="add"?(l.checkType=null,l.checkImage=[],l.baseImage=[],l.tolerance=.6,s.value={}):s.value=n}}),(d,o)=>{const n=v("Select"),T=v("el-image"),F=v("Pane");return c(),f(F,{ref_key:"refPane",ref:x},{default:e(()=>[t($,null,{default:e(()=>[m.operateType==="add"?(c(),f(V,{key:0,cols:"12",md:"7"},{default:e(()=>[t(R,{title:"输入"},{default:e(()=>[t(X,{ref_key:"refForm",ref:I,class:"my-form"},{default:e(()=>[t(n,{placeholder:"请选择检测类型",rules:[a=>!!a||"请选择检测类型"],mapDictionary:{code:"face_check_type"},modelValue:l.checkType,"onUpdate:modelValue":o[0]||(o[0]=a=>l.checkType=a)},{prepend:e(()=>[le]),_:1},8,["rules","modelValue"]),t(q,{modelValue:l.checkImage,"onUpdate:modelValue":o[1]||(o[1]=a=>l.checkImage=a),"prepend-icon":null,accept:"image/*",label:"请上传检测图片","hide-details":"auto",variant:"outlined",rules:[a=>a.length>0||"请上传检测图片"]},{prepend:e(()=>[oe]),append:e(()=>[t(N,{src:S.value.checkImage,width:"80px",alt:"previewImageUrl",cover:"",class:"rounded-md align-end text-right"},null,8,["src"])]),_:1},8,["modelValue","rules"]),t(ee,{type:"text",placeholder:"格式：top, right, bottom, left","hide-details":"auto",clearable:"",modelValue:l.faceMargin,"onUpdate:modelValue":o[2]||(o[2]=a=>l.faceMargin=a),rules:[a=>!a||/^(\d{1,4},\d{1,4},\d{1,4},\d{1,4})$/.test(a)||"请输入正确格式：top, right, bottom, left"]},{prepend:e(()=>[i("label",null,[r("人脸边距 "),t(K,null,{default:e(()=>[r("人脸边距约束，格式：top, right, bottom, left")]),_:1})])]),_:1},8,["modelValue","rules"]),l.checkType===2?(c(),B(M,{key:0},[t(q,{modelValue:l.baseImage,"onUpdate:modelValue":o[3]||(o[3]=a=>l.baseImage=a),"prepend-icon":null,accept:"image/*",label:"请上传比对图片","hide-details":"auto",variant:"outlined",rules:[a=>a.length>0||"请上传比对图片"]},{prepend:e(()=>[ne]),append:e(()=>[t(N,{src:S.value.baseImage,width:"80px",alt:"previewImageUrl",cover:"",class:"rounded-md align-end text-right"},null,8,["src"])]),_:1},8,["modelValue","rules"]),t(ae,{class:"mx-0",modelValue:l.tolerance,"onUpdate:modelValue":o[4]||(o[4]=a=>l.tolerance=a),color:"primary",max:1,min:0,step:.1,"hide-details":"auto","thumb-label":""},{append:e(()=>[i("div",se,u(l.tolerance),1)]),prepend:e(()=>[re]),_:1},8,["modelValue"])],64)):b("",!0)]),_:1},512),t(Y,{color:"primary",block:"",size:"large",flat:"",loading:w.value,onClick:_},{default:e(()=>[r("开始检测")]),_:1},8,["loading"])]),_:1})]),_:1})):b("",!0),t(V,{class:j({"result-right":m.operateType==="edit"}),cols:"12",md:m.operateType==="add"?5:0},{default:e(()=>[t(R,{title:"输出"},{default:e(()=>[s.value.inputS3Url?(c(),f(y,{key:0,class:"image-vs"},{prepend:e(()=>[ie]),default:e(()=>[t(T,{class:"w-[350px] h-[350px]",src:s.value.inputS3Url,fit:"contain"},null,8,["src"]),de,t(T,{class:"w-[350px] h-[350px]",src:s.value.outputS3Url,fit:"contain"},null,8,["src"])]),_:1})):b("",!0),s.value.faceMargin?(c(),f(y,{key:1},{prepend:e(()=>[ue]),default:e(()=>[r(" "+u(s.value.faceMargin),1)]),_:1})):b("",!0),t(y,null,{prepend:e(()=>[ce]),default:e(()=>[r(" "+u(s.value.faceNum),1)]),_:1}),s.value.outputS3Url?(c(),f(y,{key:2},{prepend:e(()=>[pe]),default:e(()=>[r(" "+u(s.value.denoiseStrength),1)]),_:1})):b("",!0),s.value.dist?(c(),f(y,{key:3},{prepend:e(()=>[me]),default:e(()=>[r(" "+u(s.value.dist.toFixed(4)),1)]),_:1})):b("",!0),l.checkType===2||s.value.outputS3Url?(c(),f(y,{key:4},{prepend:e(()=>[_e]),default:e(()=>[r(" "+u(s.value.isSame===void 0?"":s.value.isSame?"是":"否"),1)]),_:1})):b("",!0)]),_:1})]),_:1},8,["class","md"])]),_:1})]),_:1},512)}}});const he=te(fe,[["__scopeId","data-v-bc6cae62"]]),ge=["src"],be=["src"],Fe=L({__name:"faceRecognition",setup(k){const U=h({title:"人脸检测"}),P=h([{text:"图像服务",disabled:!1,href:"#"},{text:"人脸检测",disabled:!0,href:"#"}]),g=C({list:[],total:0}),m=h(),x=h(),I=_=>{let d=[];return d.push({text:"查看",color:"info",click(){S(_)}}),d},l=async(_={})=>{const[d,o]=await W.get({url:"/esrgan/list",showLoading:x.value.el,data:{modelType:"faceRecognition",..._}});o?(g.list=o.list||[],g.total=o.total):(g.list=[],g.total=0)},s=()=>{x.value.query({page:1})},w=()=>{m.value.show({title:"创建检测",operateType:"add"})},S=_=>{m.value.show({title:"查看",infos:_,operateType:"edit"})};return Z(()=>{l()}),(_,d)=>{const o=v("ButtonsInForm"),n=v("el-table-column"),T=v("ButtonsInTable"),F=v("TableWithPager");return c(),B(M,null,[t(E,{title:U.value.title,breadcrumbs:P.value},null,8,["title","breadcrumbs"]),t(R,null,{default:e(()=>[t($,null,{default:e(()=>[t(V,{cols:"12",lg:"3",md:"4",sm:"6"},{default:e(()=>[t(o,null,{default:e(()=>[t(Y,{color:"primary",onClick:w},{default:e(()=>[r("创建检测")]),_:1})]),_:1})]),_:1}),t(V,{cols:"12"},{default:e(()=>[t(F,{onQuery:l,ref_key:"tableWithPagerRef",ref:x,infos:g},{default:e(()=>[t(n,{label:"检测图片","min-width":"150px"},{default:e(({row:a})=>[t(D,{size:"80",rounded:"md"},{default:e(()=>[i("img",{src:a.inputS3Url,alt:"检测图片",height:"80"},null,8,ge)]),_:2},1024)]),_:1}),t(n,{label:"比对图片","min-width":"150px"},{default:e(({row:a})=>[a.outputS3Url?(c(),f(D,{key:0,size:"80",rounded:"md"},{default:e(()=>[i("img",{src:a.outputS3Url,alt:"比对图片",height:"80"},null,8,be)]),_:2},1024)):(c(),B(M,{key:1},[r(" -- ")],64))]),_:1}),t(n,{label:"人脸个数",prop:"faceNum","min-width":"160px"}),t(n,{label:"比对阈值",prop:"denoiseStrength","min-width":"160px"}),t(n,{label:"比分","min-width":"100px"},{default:e(({row:a})=>[r(u(a.dist.toFixed(4)),1)]),_:1}),t(n,{label:"人脸边距",prop:"faceMargin","min-width":"160px"},{default:e(({row:a})=>[t($,{class:"text-left",dense:""},{default:e(()=>[t(V,{cols:"12"},{default:e(()=>[r("req: "+u(a.faceMargin),1)]),_:2},1024),t(V,{cols:"12"},{default:e(()=>[r("real: "+u(a.faceMarginReal),1)]),_:2},1024)]),_:2},1024)]),_:1}),t(n,{label:"是否同一个人","min-width":"120px"},{default:e(({row:a})=>[t(A,{modelValue:a.isSame,"onUpdate:modelValue":z=>a.isSame=z},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(n,{label:"py耗时",prop:"durationPy","min-width":"90px"},{default:e(({row:a})=>[r(u(a.durationPy.toFixed(4)),1)]),_:1}),t(n,{label:"接口耗时",prop:"duration","min-width":"90px"},{default:e(({row:a})=>[r(u(a.duration.toFixed(4)),1)]),_:1}),t(n,{label:"操作人",prop:"operatorEmail","min-width":"150px","show-overflow-tooltip":""}),t(n,{label:"创建时间","min-width":"165px"},{default:e(({row:a})=>[r(u(G(J).dateFormat(a.createdAt,"YYYY-MM-DD HH:mm:ss")),1)]),_:1}),t(n,{label:"操作",width:"80px",fixed:"right"},{default:e(({row:a})=>[t(T,{buttons:I(a),onlyOne:""},null,8,["buttons"])]),_:1})]),_:1},8,["infos"])]),_:1})]),_:1})]),_:1}),t(he,{ref_key:"createRecognitionPaneRef",ref:m,onSubmit:s},null,512)],64)}}});export{Fe as default};
