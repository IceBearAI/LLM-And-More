import{d as ee,x as Y,z as le,r as k,aC as E,aB as X,a8 as j,U as T,k as U,l as G,m as l,W as u,j as e,n as o,_,Z as H,F as de,Y as F,al as re,am as se,av as S,Q as Ce,a3 as Ue,ac as De,at as Ie,au as $e,o as Me,aA as Pe,$ as L}from"./utils-f1e2951f.js";import{_ as we}from"./BaseBreadcrumb.vue_vue_type_style_index_0_lang-08a6585e.js";import{_ as Se}from"./UiParentCard.vue_vue_type_script_setup_true_lang-cae299fc.js";import{A as Fe}from"./AlertBlock-85347c88.js";import{C as Be}from"./ChipBoolean-c728005f.js";import{C as Ge}from"./ChipStatus-7650b4a9.js";import{_ as $}from"./Explain.vue_vue_type_style_index_0_lang-c9b62320.js";import{c as qe,a5 as x,ae as Ae,_ as ue,V as J,ac as Le,ah as Qe}from"./index-7a249bbf.js";import{V as te}from"./VSwitch-024108b9.js";import{V as ze}from"./VTextarea-aef5f788.js";import{V as Re,a as We,b as Ee,c as Ye}from"./VExpansionPanel-3306c60f.js";import{V as ie,a as K}from"./VRadioGroup-8c710edb.js";import{V as me}from"./VForm-e8a0f729.js";import{V as je}from"./VCheckbox-7ffbbb7b.js";import{_ as He}from"./ConfirmByInput.vue_vue_type_style_index_0_lang-fda17e11.js";import{_ as Ke}from"./ConfirmByClick.vue_vue_type_style_index_0_lang-7ae45c45.js";import{_ as Oe}from"./DialogLog.vue_vue_type_style_index_0_lang-7f481b87.js";import{V as w}from"./VCol-61c9553c.js";import{V as ne}from"./VRow-276356c1.js";import{I as Ze}from"./IconFileDescription-dcc1a1f3.js";import{I as Je}from"./IconTerminal2-4d9440d1.js";import"./IconInfoCircle-692a5cf4.js";import"./VAlert-a0281362.js";import"./Confirm-7827dd76.js";import"./TextLog-e45811f5.js";var Xe=qe("messages","IconMessages",[["path",{d:"M21 14l-3 -3h-7a1 1 0 0 1 -1 -1v-6a1 1 0 0 1 1 -1h9a1 1 0 0 1 1 1v10",key:"svg-0"}],["path",{d:"M14 15v2a1 1 0 0 1 -1 1h-7l-3 3v-10a1 1 0 0 1 1 -1h2",key:"svg-1"}]]);const N=D=>(re("data-v-49aadead"),D=D(),se(),D),el={class:"mx-auto mt-10",style:{width:"500px"}},ll=N(()=>u("label",{class:"required"},"模型名称",-1)),ol=N(()=>u("label",{class:"required"},"最长上下文",-1)),al={class:"required"},tl=N(()=>u("label",{class:"required"},"模型类型",-1)),nl=N(()=>u("label",null,"备注",-1)),dl=N(()=>u("label",null,"基础模型",-1)),rl=N(()=>u("label",null,"并行/实例数",-1)),sl=N(()=>u("label",null,"调度标签",-1)),ul=N(()=>u("label",null,"k8s集群",-1)),il=N(()=>u("label",null,"推理类型",-1)),ml=N(()=>u("label",null,"CPU数量",-1)),pl=N(()=>u("label",null,"GPU数量",-1)),cl=N(()=>u("label",null,"内存",-1)),fl=ee({__name:"PaneModel",emits:["submit"],setup(D,{expose:z,emit:R}){const b=Y({operateType:"add",disabledField:!1,maxTokens:5e6,formData:{id:"",modelName:"",maxTokens:0,isFineTuning:!1,enabled:!0,remark:"",parameters:0,providerName:"",modelType:null,baseModelName:null,replicas:0,label:null,k8sCluster:null,inferredType:"",cpu:0,gpu:0,memory:0}}),{formData:t}=le(b),n=R,q=k(),g=k(),V=Y({modelName:[c=>E.isModelName({value:c,required:!0})],maxTokens:[c=>c!==""?c<1?"下限 1":c>b.maxTokens?"上限 "+X.commaString(b.maxTokens):!0:"请输入模型最长上下文"],providerName:[c=>c&&c.length>0?!0:"请选择供应"],modelType:[c=>!!c||"请选择模型类型"],replicas:[c=>E.validNumberInput(c,0,50,"",!0)],cpu:[c=>E.validNumberInput(c,0,100,"",!0)],gpu:[c=>E.validNumberInput(c,0,20,"",!0)],memory:[c=>E.validNumberInput(c,0,100,"",!0)]}),B=c=>{c!=="digitalhuman"&&(b.formData.replicas=0,b.formData.label=null,b.formData.k8sCluster=null,b.formData.inferredType="",b.formData.cpu=0,b.formData.gpu=0,b.formData.memory=0)},h=async(c={})=>{const[r,s]=await S.post({...c,showSuccess:!0,url:"/models",data:{...b.formData}});s&&(q.value.hide(),n("submit"))},v=async(c={})=>{const[r,s]=await S.put({...c,showSuccess:!0,url:`/models/${b.formData.id}`,data:{...b.formData}});s&&(q.value.hide(),n("submit"))},M=({valid:c,showLoading:r})=>{c&&(b.operateType=="add"?h({showLoading:r}):v({showLoading:r}))};return z({show({title:c,infos:r={id:"",modelName:"",maxTokens:0,isFineTuning:!1,enabled:!0,remark:"",providerName:"",parameters:0,modelType:null,baseModelName:null,replicas:0,label:null,k8sCluster:null,inferredType:"",cpu:0,gpu:0,memory:0},operateType:s}){q.value.show({title:c,refForm:g}),b.formData=j.pick(j.cloneDeep(r),["id","modelName","maxTokens","isFineTuning","enabled","remark","providerName","parameters","modelType","baseModelName","replicas","label","k8sCluster","inferredType","cpu","gpu","memory"]),b.operateType=s,s=="add"?b.disabledField=!1:b.disabledField=!0}}),(c,r)=>{const s=T("Select"),d=T("Pane");return U(),G(d,{ref_key:"refPane",ref:q,class:"",onSubmit:M},{default:l(()=>[u("div",el,[e(me,{ref_key:"refForm",ref:g,class:"my-form"},{default:l(()=>[e(x,{density:"compact",variant:"outlined",type:"text",placeholder:"只允许字母、数字、“-” 、“.” 和 “:” ","hide-details":"auto",clearable:"",rules:V.modelName,modelValue:o(t).modelName,"onUpdate:modelValue":r[0]||(r[0]=a=>o(t).modelName=a),disabled:b.disabledField},{prepend:l(()=>[ll]),_:1},8,["rules","modelValue","disabled"]),e(x,{density:"compact",variant:"outlined",type:"number",placeholder:"上限 "+o(X).commaString(b.maxTokens),"hide-details":"auto",rules:V.maxTokens,modelValue:o(t).maxTokens,"onUpdate:modelValue":r[1]||(r[1]=a=>o(t).maxTokens=a),modelModifiers:{number:!0}},{prepend:l(()=>[ol]),_:1},8,["placeholder","rules","modelValue"]),e(s,{placeholder:"请选择供应商",rules:V.providerName,mapDictionary:{code:"model_provider_name"},modelValue:o(t).providerName,"onUpdate:modelValue":r[2]||(r[2]=a=>o(t).providerName=a),disabled:b.disabledField},{prepend:l(()=>[u("label",al,[_("供应 "),e($,null,{default:l(()=>[_("供应商指的是外部服务提供，自己有服务请选择Local")]),_:1})])]),_:1},8,["rules","modelValue","disabled"]),e(s,{placeholder:"请选择模型类型",rules:V.modelType,mapDictionary:{code:"model_type"},modelValue:o(t).modelType,"onUpdate:modelValue":[r[3]||(r[3]=a=>o(t).modelType=a),B],disabled:b.disabledField},{prepend:l(()=>[tl]),_:1},8,["rules","modelValue","disabled"]),e(te,{modelValue:o(t).enabled,"onUpdate:modelValue":r[4]||(r[4]=a=>o(t).enabled=a),color:"primary","hide-details":"auto"},{prepend:l(()=>[u("label",null,[_("启用 "),e($,null,{default:l(()=>[_("模型是否可被使用，如果关闭则无法使用该模型")]),_:1})])]),_:1},8,["modelValue"]),e(ze,{modelValue:o(t).remark,"onUpdate:modelValue":r[5]||(r[5]=a=>o(t).remark=a),modelModifiers:{trim:!0},placeholder:"请输入"},{prepend:l(()=>[nl]),_:1},8,["modelValue"]),e(Ae,null,{default:l(()=>[e(Re,null,{default:l(()=>[e(We,{elevation:"10"},{default:l(()=>[e(Ee,{class:"text-h6"},{default:l(()=>[_("高级")]),_:1}),e(Ye,{class:"mt-4",eager:""},{default:l(()=>[e(s,{placeholder:"请选择基础模型",modelValue:o(t).baseModelName,"onUpdate:modelValue":r[6]||(r[6]=a=>o(t).baseModelName=a),mapAPI:{url:"/channels/models",data:{providerName:"LocalAI",modelType:"text-generation",baseModelName:"null"},labelField:"modelName",valueField:"modelName"},"hide-details":!1},{prepend:l(()=>[dl]),_:1},8,["modelValue"]),e(te,{modelValue:o(t).isFineTuning,"onUpdate:modelValue":r[7]||(r[7]=a=>o(t).isFineTuning=a),disabled:b.disabledField,color:"primary"},{prepend:l(()=>[u("label",null,[_("微调 "),e($,null,{default:l(()=>[_("是否是微调模型")]),_:1})])]),_:1},8,["modelValue","disabled"]),e(x,{density:"compact",variant:"outlined",type:"number",placeholder:"请输入参数量",modelValue:o(t).parameters,"onUpdate:modelValue":r[8]||(r[8]=a=>o(t).parameters=a),modelModifiers:{number:!0},style:{width:"60%"},disabled:b.disabledField},{prepend:l(()=>[u("label",null,[_("参数量(B) "),e($,null,{default:l(()=>[_("单位是B，代理10亿")]),_:1})])]),_:1},8,["modelValue","disabled"]),o(t).modelType==="digitalhuman"?(U(),H(de,{key:0},[e(x,{type:"number",placeholder:"请输入并行/实例数",rules:V.replicas,modelValue:o(t).replicas,"onUpdate:modelValue":r[9]||(r[9]=a=>o(t).replicas=a),modelModifiers:{number:!0}},{prepend:l(()=>[rl]),_:1},8,["rules","modelValue"]),e(s,{placeholder:"请选择调度标签","hide-details":!1,mapDictionary:{code:"model_deploy_label"},modelValue:o(t).label,"onUpdate:modelValue":r[10]||(r[10]=a=>o(t).label=a)},{prepend:l(()=>[sl]),_:1},8,["modelValue"]),e(s,{placeholder:"请选择k8s集群","hide-details":!1,mapDictionary:{code:"k8s_cluster"},modelValue:o(t).k8sCluster,"onUpdate:modelValue":r[11]||(r[11]=a=>o(t).k8sCluster=a)},{prepend:l(()=>[ul]),_:1},8,["modelValue"]),e(ie,{modelValue:o(t).inferredType,"onUpdate:modelValue":r[12]||(r[12]=a=>o(t).inferredType=a),inline:"",color:"primary"},{prepend:l(()=>[il]),default:l(()=>[e(K,{label:"CPU",value:"cpu"}),e(K,{label:"GPU",value:"gpu"})]),_:1},8,["modelValue"]),e(x,{type:"number",placeholder:"请输入使用CPU数量",rules:V.cpu,modelValue:o(t).cpu,"onUpdate:modelValue":r[13]||(r[13]=a=>o(t).cpu=a),modelModifiers:{number:!0}},{prepend:l(()=>[ml]),_:1},8,["rules","modelValue"]),e(x,{type:"number",placeholder:"请输入使用GPU数量",rules:V.gpu,modelValue:o(t).gpu,"onUpdate:modelValue":r[14]||(r[14]=a=>o(t).gpu=a),modelModifiers:{number:!0}},{prepend:l(()=>[pl]),_:1},8,["rules","modelValue"]),e(x,{type:"number",placeholder:"请输入内存",rules:V.memory,modelValue:o(t).memory,"onUpdate:modelValue":r[15]||(r[15]=a=>o(t).memory=a),modelModifiers:{number:!0}},{prepend:l(()=>[cl]),"append-inner":l(()=>[_("G")]),_:1},8,["rules","modelValue"])],64)):F("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},512)])]),_:1},512)}}});const _l=ue(fl,[["__scopeId","data-v-49aadead"]]),Q=D=>(re("data-v-bc449c1b"),D=D(),se(),D),bl={class:"mx-auto mt-10",style:{width:"500px"}},yl=Q(()=>u("label",{class:"required"},"模型名称",-1)),Vl={class:"required"},hl={class:"required"},kl=Q(()=>u("label",{class:"required"},"推理类型",-1)),gl=Q(()=>u("label",{class:"required"},"CPU数量",-1)),xl={class:"required"},vl=Q(()=>u("label",null,"k8s集群",-1)),Tl=Q(()=>u("label",null,null,-1)),Nl=Q(()=>u("label",null,"推理加速",-1)),Cl=ee({__name:"ArrangeModel",emits:["submit"],setup(D,{expose:z,emit:R}){const b=/^\+?[1-9][0-9]*$/,t=Y({operateType:"",maxTokens:5e5,id:"",modelName:"",isQuantify:!1,formData:{replicas:"",label:"",cpu:1,gpu:1,maxGpuMemory:"",quantization:"",inferredType:"cpu",k8sCluster:null,modelWorker:null}}),{formData:n,id:q}=le(t),g=R,V=k(),B=k(),h=(s,d,a,P,f=!1)=>s?s<d?`下限 ${d}`:s>a?`上限 ${a}`:f&&b.test(s)!=!0?"请输入正整数":!0:P||!0,v=Y({replicas:[s=>h(s,1,8,"请输入实例数量",!0)],label:[s=>!!s||"请选择调度标签"],gpu:[s=>h(s,1,8,"请输入使用GPU数量",!0)],cpu:[s=>h(s,1,80,"请输入使用CPU数量",!0)],maxGpuMemory:[s=>h(s,1,80,"",!0)],quantization:[s=>!!s||"请选择精度"],isQuantify:[s=>s&&s!=!1?!0:"请开启量化"]}),M=async(s={})=>{t.formData.quantization=t.isQuantify?"float16":""},c=s=>{s==="cpu"?t.formData.gpu=1:t.formData.cpu=1},r=async({valid:s,showLoading:d})=>{if(s){const a={...t.formData};a.inferredType==="cpu"?(a.gpu=0,a.maxGpuMemory=0):a.cpu=0,a.maxGpuMemory=a.maxGpuMemory||0,a.modelWorker=a.modelWorker||"";const[P,f]=await S.post({...d,showSuccess:!0,url:`/api/models/${t.id}/deploy`,data:a});f&&(V.value.hide(),g("submit"))}};return z({show({title:s,infos:d={id:"",modelName:""},operateType:a}){V.value.show({title:s,refForm:B}),t.formData=j.pick(j.cloneDeep(d),[]),t.formData.inferredType="cpu",t.formData.cpu=1,t.formData.gpu=1,t.operateType=a,t.modelName=d.modelName,t.id=d.id}}),(s,d)=>{const a=T("Select"),P=T("Pane");return U(),G(P,{ref_key:"refPane",ref:V,class:"",onSubmit:r},{default:l(()=>[u("div",bl,[e(me,{ref_key:"refForm",ref:B,class:"my-form"},{default:l(()=>[e(x,{"hide-details":"auto",modelValue:t.modelName,"onUpdate:modelValue":d[0]||(d[0]=f=>t.modelName=f),disabled:!0},{prepend:l(()=>[yl]),_:1},8,["modelValue"]),e(x,{type:"number","hide-details":"auto",placeholder:"请输入使用实例数量",rules:v.replicas,modelValue:o(n).replicas,"onUpdate:modelValue":d[1]||(d[1]=f=>o(n).replicas=f),modelModifiers:{number:!0},onInput:d[2]||(d[2]=f=>h(o(n).replicas,1,8,"请输入实例数量",!0)),max:"8"},{prepend:l(()=>[u("label",Vl,[_("实例数 "),e($,null,{default:l(()=>[_("启动实例数量")]),_:1})])]),_:1},8,["rules","modelValue"]),e(a,{"hide-details":"auto",placeholder:"请选择调度标签",rules:v.label,mapDictionary:{code:"model_deploy_label"},modelValue:o(n).label,"onUpdate:modelValue":d[3]||(d[3]=f=>o(n).label=f)},{prepend:l(()=>[u("label",hl,[_("调度标签 "),e($,null,{default:l(()=>[_("设置实例调度的节点亲和性")]),_:1})])]),_:1},8,["rules","modelValue"]),e(ie,{modelValue:o(n).inferredType,"onUpdate:modelValue":[d[4]||(d[4]=f=>o(n).inferredType=f),c],inline:"",color:"primary","hide-details":"auto"},{prepend:l(()=>[kl]),default:l(()=>[e(K,{label:"CPU",value:"cpu"}),e(K,{label:"GPU",value:"gpu"})]),_:1},8,["modelValue"]),o(n).inferredType==="cpu"?(U(),G(x,{key:0,type:"number",placeholder:"请输入使用CPU数量",rules:v.cpu,modelValue:o(n).cpu,"onUpdate:modelValue":d[5]||(d[5]=f=>o(n).cpu=f),modelModifiers:{number:!0},onInput:d[6]||(d[6]=f=>h(o(n).cpu,1,80,"请输入使用CPU数量",!0)),max:"80","hide-details":"auto"},{prepend:l(()=>[gl]),_:1},8,["rules","modelValue"])):F("",!0),o(n).inferredType==="gpu"?(U(),G(x,{key:1,type:"number",placeholder:"请输入使用GPU数量",rules:v.gpu,modelValue:o(n).gpu,"onUpdate:modelValue":d[7]||(d[7]=f=>o(n).gpu=f),modelModifiers:{number:!0},onInput:d[8]||(d[8]=f=>h(o(n).gpu,1,8,"请输入使用GPU数量",!0)),max:"8","hide-details":"auto"},{prepend:l(()=>[u("label",xl,[_("GPU数量 "),e($,null,{default:l(()=>[_("单实例GPU数量")]),_:1})])]),_:1},8,["rules","modelValue"])):F("",!0),o(n).gpu>1?(U(),G(x,{key:2,type:"number",placeholder:"请输入GPU内存",rules:v.maxGpuMemory,modelValue:o(n).maxGpuMemory,"onUpdate:modelValue":d[9]||(d[9]=f=>o(n).maxGpuMemory=f),modelModifiers:{number:!0},onInput:d[10]||(d[10]=f=>h(o(n).maxGpuMemory,1,80,"",!0)),max:"80","hide-details":"auto"},{prepend:l(()=>[u("label",null,[_("GPU内存 "),e($,null,{default:l(()=>[_("指定每个 GPU 用于存储模型权重的最大内存。这允许它为激活分配更多内存，因此您可以使用更长的上下文长度或更大的批量大小")]),_:1})])]),"append-inner":l(()=>[_(" GiB ")]),_:1},8,["rules","modelValue"])):F("",!0),e(a,{placeholder:"请选择k8s集群","hide-details":"auto",mapDictionary:{code:"k8s_cluster"},modelValue:o(n).k8sCluster,"onUpdate:modelValue":d[11]||(d[11]=f=>o(n).k8sCluster=f)},{prepend:l(()=>[vl]),_:1},8,["modelValue"]),e(je,{label:"开启量化",modelValue:t.isQuantify,"onUpdate:modelValue":d[12]||(d[12]=f=>t.isQuantify=f),onChange:M,"hide-details":"auto",color:"primary"},{prepend:l(()=>[u("label",null,[_("量化 "),e($,null,{default:l(()=>[_("对模型启动进行量化，节约显存提升推理速度")]),_:1})])]),_:1},8,["modelValue"]),Ce(e(a,{placeholder:"请选择精度",mapDictionary:{code:"model_deploy_quantization"},modelValue:o(n).quantization,"onUpdate:modelValue":d[13]||(d[13]=f=>o(n).quantization=f),style:{"margin-top":"-14px"},"hide-details":"auto"},{prepend:l(()=>[Tl]),_:1},8,["modelValue"]),[[Ue,t.isQuantify]]),e(a,{placeholder:"请选择加速方式","hide-details":"auto",mapDictionary:{code:"model_worker"},modelValue:o(n).modelWorker,"onUpdate:modelValue":d[14]||(d[14]=f=>o(n).modelWorker=f)},{prepend:l(()=>[Nl]),_:1},8,["modelValue"])]),_:1},512)])]),_:1},512)}}});const Ul=ue(Cl,[["__scopeId","data-v-bc449c1b"]]),Dl=["onClick"],Il={key:0,style:{width:"80px"},class:"mx-auto mb-4"},$l=u("span",{class:"text-body-2 text-lightText"},"部署中",-1),Ml={key:1},Pl=["onClick"],wl={class:"text-primary font-weight-black"},Sl=u("br",null,null,-1),Fl=u("br",null,null,-1),Bl=["innerHTML"],Gl={class:"d-flex align-center h-[50px]"},ql=u("span",null,"日志",-1),mo=ee({__name:"modelList",setup(D){const{loadDictTree:z,getLabels:R}=De(),b=Ie(),t=$e(),n=Y({style:{},formData:{modelName:"",enabled:null,providerName:null,modelType:null},selectedInfo:{id:"",modelName:"",containerNames:[]},tableInfos:{list:[],total:""},confirmByClickInfo:{html:"",action:"",row:{}}}),{style:q,formData:g}=le(n),V=k(),B=k(),h=k(),v=k(),M=k(),c=k(),r=k({title:"模型列表"}),s=k([{text:"模型管理",disabled:!1,href:"#"},{text:"模型列表",disabled:!0,href:"#"}]),d=k(),a=k(null),P=({id:i,modelName:p}={})=>{p?b.push("/model/chat-playground?modelName="+p+"&modelId="+i):b.push("/model/chat-playground")},f=({id:i,modelName:p})=>{b.push(`/model/model-list/detail?jobId=${i}&modelName=`+p)},pe=i=>{let p=[];for(let y of i.operation)y=="edit"?p.push({text:"编辑",color:"info",click(){Ve(i)}}):y=="delete"?p.push({text:"删除",color:"error",click(){_e(i)}}):y=="deploy"?p.push({text:"部署",color:"info",click(){B.value.show({title:"部署模型",infos:i})}}):y=="undeploy"&&p.push({text:"卸载",color:"info",click(){j.assign(n.confirmByClickInfo,{html:"确认卸载模型 <span class='text-primary mx-1  font-weight-black'>"+i.modelName+"</span>吗？",action:"undeploy",row:i}),M.value.show({width:"350px"})}});return p},ce=(i={})=>{let{action:p,row:y}=n.confirmByClickInfo;p=="deploy"?he(y,i):p=="undeploy"&&ke(y,i)},fe=async(i={})=>{await z(["model_type"]);const[p,y]=await S.get({url:"/models",showLoading:v.value.el,data:{...n.formData,...i}});y?(n.tableInfos.list=y.list,n.tableInfos.total=y.total):(n.tableInfos.list=[],n.tableInfos.total=0),c.value.start()},I=()=>{v.value.query({page:1})},O=()=>{v.value.query()},_e=i=>{n.selectedInfo=i,h.value.show({width:"400px",confirmText:n.selectedInfo.modelName})},be=async(i={})=>{const[p,y]=await S.delete({...i,showSuccess:!0,url:`/api/models/${n.selectedInfo.id}`});y&&(h.value.hide(),I())},ye=()=>{V.value.show({title:"添加模型",operateType:"add"})},Ve=i=>{V.value.show({title:"编辑模型",infos:i,operateType:"edit"})},he=async(i,p)=>{let[y,W]=await S.post({...p,showSuccess:!0,url:`/api/models/${i.id}/deploy`});W&&(M.value.hide(),O())},ke=async(i,p)=>{let[y,W]=await S.post({...p,showSuccess:!0,url:`/api/models/${i.id}/undeploy`});W&&(M.value.hide(),O())},ge=async i=>{const p=i.containerNames||[];n.selectedInfo=i,a.value=p[0],d.value.show()},oe=async()=>{let[i,p]=await S.get({url:`/api/models/${n.selectedInfo.modelName}/container/${a.value}/logs`});if(p){const y=Object.keys(p).length===0?"":p;d.value.setContent(y)}},ae=i=>i.baseModelName||i.providerName!=="LocalAI"?!1:i.enabled&&i.modelType==="text-generation"||i.operation.indexOf("undeploy")!==-1;return Me(()=>{let{modelName:i}=t.query;i&&(n.formData.modelName=i),I()}),(i,p)=>{const y=T("Select"),W=T("refresh-button"),xe=T("ButtonsInForm"),Z=T("el-tooltip"),C=T("el-table-column"),ve=T("router-link"),Te=T("ButtonsInTable"),Ne=T("TableWithPager");return U(),H(de,null,[e(we,{title:r.value.title,breadcrumbs:s.value},null,8,["title","breadcrumbs"]),e(ne,null,{default:l(()=>[e(w,null,{default:l(()=>[e(Se,null,{default:l(()=>[e(ne,null,{default:l(()=>[e(w,{cols:"12",lg:"3",md:"4",sm:"6"},{default:l(()=>[e(x,{density:"compact",modelValue:o(g).modelName,"onUpdate:modelValue":p[0]||(p[0]=m=>o(g).modelName=m),label:"搜索模型名称","hide-details":"",clearable:"",variant:"outlined",color:"red",onKeyup:Pe(I,["enter"]),"onClick:clear":I},null,8,["modelValue","onKeyup"])]),_:1}),e(w,{cols:"12",lg:"2",md:"4",sm:"6"},{default:l(()=>[e(y,{onChange:I,label:"请选择状态",mapDictionary:{code:"local_enabled"},modelValue:o(g).enabled,"onUpdate:modelValue":p[1]||(p[1]=m=>o(g).enabled=m)},null,8,["modelValue"])]),_:1}),e(w,{cols:"12",lg:"2",md:"4",sm:"6"},{default:l(()=>[e(y,{onChange:I,label:"请选择模型类型",mapDictionary:{code:"model_type"},modelValue:o(g).modelType,"onUpdate:modelValue":p[2]||(p[2]=m=>o(g).modelType=m)},null,8,["modelValue"])]),_:1}),e(w,{cols:"12",lg:"2",md:"4",sm:"6"},{default:l(()=>[e(y,{onChange:I,label:"请选择供应",mapDictionary:{code:"model_provider_name"},modelValue:o(g).providerName,"onUpdate:modelValue":p[3]||(p[3]=m=>o(g).providerName=m)},null,8,["modelValue"])]),_:1}),e(w,{cols:"12",lg:"3",md:"4",sm:"6"},{default:l(()=>[e(xe,null,{default:l(()=>[e(J,{color:"primary",onClick:P},{default:l(()=>[_("聊天操场")]),_:1}),e(J,{color:"primary",onClick:ye},{default:l(()=>[_("添加模型")]),_:1}),e(W,{ref_key:"refreshButtonRef",ref:c,onRefresh:O},null,512)]),_:1})]),_:1}),e(w,{cols:"12"},{default:l(()=>[e(Fe,null,{default:l(()=>[_(" 修改之后将实时生效，请谨慎操作！ ")]),_:1})]),_:1}),e(w,{cols:"12"},{default:l(()=>[e(Ne,{onQuery:fe,ref_key:"refTableWithPager",ref:v,infos:n.tableInfos},{default:l(()=>[e(C,{label:"模型",width:"200px",fixed:"left"},{default:l(({row:m})=>[e(Z,{content:"查看详情",placement:"top"},{default:l(()=>[u("span",{class:"link",onClick:A=>f(m)},L(m.modelName),9,Dl)]),_:2},1024)]),_:1}),e(C,{label:"最长上下文",width:"110px"},{default:l(({row:m})=>[u("span",null,L(m.maxTokens),1)]),_:1}),e(C,{label:"模型类型",width:"110px"},{default:l(({row:m})=>[u("span",null,L(o(R)([["model_type",m.modelType]])),1)]),_:1}),e(C,{label:"是否启用","min-width":"100px"},{default:l(({row:m})=>[e(Ge,{modelValue:m.enabled,"onUpdate:modelValue":A=>m.enabled=A},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(C,{label:"是否微调","min-width":"100px"},{default:l(({row:m})=>[e(Be,{modelValue:m.isFineTuning,"onUpdate:modelValue":A=>m.isFineTuning=A},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(C,{label:"部署","min-width":"150px"},{default:l(({row:m})=>[m.deployStatus=="pending"?(U(),H("div",Il,[e(Le,{height:"24",striped:"",indeterminate:"",color:"#4eb879",rounded:"",class:"mx-auto"},{default:l(()=>[$l]),_:1})])):F("",!0),m.enabled&&m.modelType==="text-generation"?(U(),H("div",Ml,[e(J,{onClick:A=>P(m),"prepend-icon":"mdi-chat",size:"small",variant:"outlined",color:"info"},{prepend:l(()=>[e(o(Xe),{size:16})]),default:l(()=>[_(" 对话 ")]),_:2},1032,["onClick"])])):F("",!0)]),_:1}),e(C,{label:"终端信息","min-width":"90px"},{default:l(({row:m})=>[ae(m)?(U(),G(Z,{key:0,content:"点击查看",placement:"top"},{default:l(()=>[u("a",{class:"link",href:"javascript: void(0)",onClick:A=>ge(m)},[e(o(Ze),{class:"align-top",size:20})],8,Pl)]),_:2},1024)):F("",!0)]),_:1}),e(C,{label:"webshell","min-width":"90px"},{default:l(({row:m})=>[ae(m)?(U(),G(Z,{key:0,content:"进入终端",placement:"top"},{default:l(()=>[e(ve,{class:"link",to:{path:"/model/terminal",query:{resourceType:"deployment",serviceName:m.modelName}},target:"_blank"},{default:l(()=>[e(o(Je),{class:"align-top",size:20})]),_:2},1032,["to"])]),_:2},1024)):F("",!0)]),_:1}),e(C,{label:"备注","min-width":"200px","show-overflow-tooltip":""},{default:l(({row:m})=>[_(L(m.remark),1)]),_:1}),e(C,{label:"更新时间","min-width":"200px"},{default:l(({row:m})=>[_(L(o(X).dateFormat(m.updatedAt,"YYYY-MM-DD HH:mm:ss")),1)]),_:1}),e(C,{label:"操作","min-width":"120px",fixed:"right"},{default:l(({row:m})=>[e(Te,{buttons:pe(m)},null,8,["buttons"])]),_:1})]),_:1},8,["infos"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(_l,{ref_key:"refPaneModel",ref:V,onSubmit:I},null,512),e(Ul,{ref_key:"refArrangeModel",ref:B,onSubmit:I},null,512),e(He,{ref_key:"refConfirmDelete",ref:h,onSubmit:be},{text:l(()=>[_(" 您将要删除 "),u("span",wl,L(n.selectedInfo.modelName),1),_(" 模型，删除之后，"),Sl,_(" 若有使用该模型的应用场景都将取消授权。 "),Fl,_("确定要继续吗？ ")]),_:1},512),e(Ke,{ref_key:"refConfirmByClick",ref:M,onSubmit:ce},{text:l(()=>[u("div",{innerHTML:n.confirmByClickInfo.html},null,8,Bl)]),_:1},512),e(Oe,{ref_key:"refDialogLog",ref:d,interval:20,onRefresh:oe},{title:l(()=>[u("div",Gl,[ql,e(Qe,{class:"w-[350px] ml-5",modelValue:a.value,"onUpdate:modelValue":[p[4]||(p[4]=m=>a.value=m),oe],clearable:!1,"hide-details":"",items:n.selectedInfo.containerNames||[],label:"请选择容器"},null,8,["modelValue","items"])])]),_:1},512)],64)}}});export{mo as default};
