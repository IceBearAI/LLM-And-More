import{_ as U}from"./ModelSelect.vue_vue_type_script_setup_true_lang-de688e9f.js";import{d as k,x as v,r as p,c as A,U as I,k as P,l as N,m as o,W as d,j as l,n as T,av as F,al as S,am as j}from"./utils-1e76329d.js";import{C as z}from"./CustomUpload-379f6f9f.js";import{V as B}from"./VRow-7ad57f36.js";import{J as q,V as D,a5 as M,_ as R}from"./index-9385247e.js";import{I as $}from"./IconPlus-8bf4c8bf.js";import{V as h}from"./VTextarea-afb7bb72.js";import{V as J}from"./VForm-acd39db9.js";const i=n=>(S("data-v-f06a51fd"),n=n(),j(),n),L={class:"mx-auto mt-3",style:{width:"540px"}},W={class:"avatar position-relative"},E=["src"],G={class:"avatar-add-btn"},H=i(()=>d("label",{class:"required"},"助手名称",-1)),K=i(()=>d("label",null,"指令",-1)),O=i(()=>d("label",{class:"required"},"模型",-1)),Q=i(()=>d("label",null,"备注",-1)),X=k({__name:"CreateAssistantPane",emits:["submit"],setup(n,{expose:V,emit:y}){const c={avatar:"",name:"",instructions:"",modelName:null,remark:""},g=y,m=v({operateType:"add"}),e=p({...c}),u=p(),f=p(),_=v({name:[t=>!!t||"请输入助手名称"],modelName:[t=>!!t||"请选择模型"]}),x=A(()=>e.value.avatar||new URL("/assets/defaultAvatar-35ab597a.png",self.location).href),w=({res:t})=>{t&&(e.value.avatar=t.s3Url)},C=async({valid:t,showLoading:a})=>{if(t){const s={url:"",method:""};m.operateType=="add"?(s.url="/assistants/create",s.method="post"):(s.url=`/assistants/${e.value.assistantId}`,s.method="put");const[r,b]=await F[s.method]({showLoading:a,showSuccess:!0,url:s.url,data:e.value});b&&(u.value.hide(),g("submit"))}};return V({show({title:t,operateType:a,infos:s}){u.value.show({title:t,refForm:f}),m.operateType=a,m.operateType==="add"?e.value={...c}:e.value={...s}}}),(t,a)=>{const s=I("Pane");return P(),N(s,{ref_key:"refPane",ref:u,onSubmit:C},{default:o(()=>[d("div",L,[l(J,{ref_key:"refForm",ref:f,class:"my-form"},{default:o(()=>[l(B,{class:"justify-center"},{default:o(()=>[d("div",W,[l(q,{size:"100"},{default:o(()=>[d("img",{src:x.value,width:"100",alt:"avatar"},null,8,E)]),_:1}),l(z,{"file-type":["image/jpeg","image/png","image/jpg"],"file-size":5,onAfterUpload:w},{trigger:o(()=>[d("div",G,[l(D,{icon:"",flat:"",color:"info",size:"x-small"},{default:o(()=>[l(T($),{"stroke-width":"2.5",size:20})]),_:1})])]),_:1})])]),_:1}),l(M,{type:"text",placeholder:"请输入助手名称","hide-details":"auto",clearable:"",rules:_.name,modelValue:e.value.name,"onUpdate:modelValue":a[0]||(a[0]=r=>e.value.name=r)},{prepend:o(()=>[H]),_:1},8,["rules","modelValue"]),l(h,{modelValue:e.value.instructions,"onUpdate:modelValue":a[1]||(a[1]=r=>e.value.instructions=r),modelModifiers:{trim:!0},"hide-details":"auto",placeholder:"请输入给AI的指令"},{prepend:o(()=>[K]),_:1},8,["modelValue"]),l(U,{placeholder:"请选择模型",rules:_.modelName,modelValue:e.value.modelName,"onUpdate:modelValue":a[2]||(a[2]=r=>e.value.modelName=r),"hide-details":"auto"},{prepend:o(()=>[O]),_:1},8,["rules","modelValue"]),l(h,{modelValue:e.value.remark,"onUpdate:modelValue":a[3]||(a[3]=r=>e.value.remark=r),modelModifiers:{trim:!0},placeholder:"请输入备注"},{prepend:o(()=>[Q]),_:1},8,["modelValue"])]),_:1},512)])]),_:1},512)}}});const re=R(X,[["__scopeId","data-v-f06a51fd"]]);export{re as C};
