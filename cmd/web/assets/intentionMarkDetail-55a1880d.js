import{_ as ne}from"./NavBack.vue_vue_type_script_setup_true_lang-8415f227.js";import{d as S,k as Q,l as H,m as t,j as e,_ as m,$ as g,n as Y,aB as A,al as X,am as ee,W as _,x as $,r as x,U as V,av as F,au as L,o as M,Z as K,aA as j,F as E}from"./utils-7cd8a09b.js";import{_ as Z}from"./UiParentCard.vue_vue_type_script_setup_true_lang-d71eddbc.js";import{c as le,ae as B,_ as te,a5 as N,V as oe}from"./index-2a19813c.js";import{V as I}from"./VCol-3d7d5d87.js";import{V as W}from"./VRow-6e3b9bcc.js";import{V as U}from"./VTextarea-4601df95.js";import{V as se}from"./VForm-a8874399.js";import{_ as re}from"./ConfirmByClick.vue_vue_type_style_index_0_lang-03d03528.js";import{C as ie}from"./CustomUpload-66947653.js";import{V as de,a as G,b as ue,c as J}from"./VWindowItem-994a0648.js";import"./Confirm-f7c8f790.js";var ce=le("pencil","IconPencil",[["path",{d:"M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4",key:"svg-0"}],["path",{d:"M13.5 6.5l4 4",key:"svg-1"}]]);const R=c=>(X("data-v-8e457af5"),c=c(),ee(),c),pe=R(()=>_("label",null,"创建人",-1)),me=R(()=>_("label",null,"创建时间",-1)),_e=R(()=>_("label",null,"更新时间",-1)),fe=R(()=>_("label",null,"备注",-1)),he=S({__name:"DetailBaseInfo",props:{info:{default:()=>({})}},setup(c){const y=c;return(f,u)=>(Q(),H(W,{class:"my-form waterfall"},{default:t(()=>[e(I,{xs:"12",sm:"6",md:"4",lg:"3"},{default:t(()=>[e(B,{"hide-details":""},{prepend:t(()=>[pe]),default:t(()=>[m(" "+g(y.info.operator),1)]),_:1})]),_:1}),e(I,{xs:"12",sm:"6",md:"4",lg:"3"},{default:t(()=>[e(B,{"hide-details":""},{prepend:t(()=>[me]),default:t(()=>[m(" "+g(Y(A).dateFormat(y.info.createdAt,"YYYY-MM-DD HH:mm:ss")),1)]),_:1})]),_:1}),e(I,{xs:"12",sm:"6",md:"4",lg:"3"},{default:t(()=>[e(B,{"hide-details":""},{prepend:t(()=>[_e]),default:t(()=>[m(" "+g(Y(A).dateFormat(y.info.updatedAt,"YYYY-MM-DD HH:mm:ss")),1)]),_:1})]),_:1}),e(I,{xs:"12",sm:"6",md:"4",lg:"3"},{default:t(()=>[e(B,{"hide-details":""},{prepend:t(()=>[fe]),default:t(()=>[m(" "+g(y.info.remark),1)]),_:1})]),_:1})]),_:1}))}});const ye=te(he,[["__scopeId","data-v-8e457af5"]]),z=c=>(X("data-v-a2a40ce9"),c=c(),ee(),c),we={class:"mx-auto mt-3",style:{width:"540px"}},be=z(()=>_("label",{class:"required"},"标准问",-1)),ve=z(()=>_("label",{class:"required"},"回答",-1)),ge=z(()=>_("label",{class:"required"},"意图",-1)),Ie=S({__name:"CreateQAPane",props:{intentId:{default:""}},emits:["submit"],setup(c,{expose:y,emit:f}){const u=c,n=f,r=$({operateType:"add"}),o=$({documentId:"",question:"",output:"",intent:""}),s=x(),p=x(),k=$({question:[i=>!!i||"请输入标准问"],output:[i=>!!i||"请输入回答"],intent:[i=>!!i||"请输入意图"]}),P=async({valid:i,showLoading:d})=>{if(i){const a={url:"",method:""};r.operateType=="add"?(a.url=`/intent/${u.intentId}/document/create`,a.method="post"):(a.url=`/api/intent/${u.intentId}/document/${o.documentId}/update`,a.method="put");const[b,h]=await F[a.method]({showLoading:d,showSuccess:!0,url:a.url,data:o});h&&(s.value.hide(),n("submit"))}};return y({show({title:i,operateType:d,infos:a}){s.value.show({title:i,refForm:p}),r.operateType=d,r.operateType==="add"?(o.question="",o.output="",o.intent=""):(o.question=a.question,o.output=a.output,o.intent=a.intent,o.documentId=a.documentId)}}),(i,d)=>{const a=V("Pane");return Q(),H(a,{ref_key:"refPane",ref:s,onSubmit:P},{default:t(()=>[_("div",we,[e(se,{ref_key:"refForm",ref:p,class:"my-form"},{default:t(()=>[e(U,{modelValue:o.question,"onUpdate:modelValue":d[0]||(d[0]=b=>o.question=b),rules:k.question,placeholder:"用户问","hide-details":"auto",rows:3},{prepend:t(()=>[be]),_:1},8,["modelValue","rules"]),e(U,{modelValue:o.output,"onUpdate:modelValue":d[1]||(d[1]=b=>o.output=b),rules:k.output,placeholder:"客服回答","hide-details":"auto",rows:3},{prepend:t(()=>[ve]),_:1},8,["modelValue","rules"]),e(U,{modelValue:o.intent,"onUpdate:modelValue":d[2]||(d[2]=b=>o.intent=b),rules:k.intent,placeholder:"意图","hide-details":"auto",rows:3},{prepend:t(()=>[ge]),_:1},8,["modelValue","rules"])]),_:1},512)])]),_:1},512)}}});const xe=te(Ie,[["__scopeId","data-v-a2a40ce9"]]),ke=["onClick"],Ve=["onClick"],$e=_("span",{class:"font-weight-bold"},"这是进行一项操作时必须了解的重要信息",-1),Ce=_("br",null,null,-1),De={class:"text-primary"},Pe=_("br",null,null,-1),qe=S({__name:"QAList",setup(c){const y=L(),{intentId:f}=y.query,u=$({keyword:""}),n=$({list:[],total:0}),r=x(),o=x(),s=x(),p=$({documentId:"",question:""}),k=l=>{let w=[];return w.push({text:"编辑",color:"info",click(){q(l)}}),w.push({text:"废弃",color:"error",click(){P(l)}}),w},P=l=>{p.documentId=l.documentId,p.question=l.question,s.value.show({width:"450px"})},i=async(l={})=>{const[w,T]=await F.delete({...l,showSuccess:!0,url:`/intent/${f}/document/${p.documentId}/delete`});T&&(s.value.hide(),b())},d=async(l={})=>{const[w,T]=await F.get({url:`/intent/${f}/document/list`,showLoading:o.value.el,data:{...u,...l}});T?(n.list=T.list||[],n.total=T.total):(n.list=[],n.total=0)},a=()=>{o.value.query({page:1})},b=()=>{o.value.query()},h=()=>{r.value.show({title:"添加问答",operateType:"add"})},q=l=>{r.value.show({title:"编辑问答",infos:l,operateType:"edit"})};return M(()=>{b()}),(l,w)=>{const T=V("ButtonsInForm"),C=V("el-table-column"),D=V("ButtonsInTable"),O=V("TableWithPager");return Q(),K(E,null,[e(W,null,{default:t(()=>[e(I,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[e(N,{modelValue:u.keyword,"onUpdate:modelValue":w[0]||(w[0]=v=>u.keyword=v),label:"请输入关键字","hide-details":"",clearable:"",onKeyup:j(a,["enter"]),"onClick:clear":a},null,8,["modelValue","onKeyup"])]),_:1}),e(I,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[e(T,null,{default:t(()=>[e(oe,{color:"primary",onClick:h},{default:t(()=>[m("添加问答")]),_:1})]),_:1})]),_:1}),e(I,{cols:"12"},{default:t(()=>[e(O,{onQuery:d,ref_key:"tableWithPagerRef",ref:o,infos:n},{default:t(()=>[e(C,{label:"ID","min-width":"240px"},{default:t(({row:v})=>[_("a",{href:"javascript: void(0)",class:"link",onClick:ae=>q(v)},g(v.documentId),9,ke)]),_:1}),e(C,{label:"标准问法","min-width":"200px","show-overflow-tooltip":""},{default:t(({row:v})=>[_("a",{href:"javascript: void(0)",class:"link",onClick:ae=>q(v)},g(v.question),9,Ve)]),_:1}),e(C,{label:"答案",prop:"output","min-width":"200px","show-overflow-tooltip":""}),e(C,{label:"意图",prop:"intent","min-width":"200px","show-overflow-tooltip":""}),e(C,{label:"更新时间","min-width":"200px"},{default:t(({row:v})=>[m(g(Y(A).dateFormat(v.updatedAt,"YYYY-MM-DD HH:mm:ss")),1)]),_:1}),e(C,{label:"添加时间","min-width":"200px"},{default:t(({row:v})=>[m(g(Y(A).dateFormat(v.createdAt,"YYYY-MM-DD HH:mm:ss")),1)]),_:1}),e(C,{label:"操作人",prop:"operator","min-width":"220px"}),e(C,{label:"操作",width:"100px",fixed:"right"},{default:t(({row:v})=>[e(D,{buttons:k(v)},null,8,["buttons"])]),_:1})]),_:1},8,["infos"])]),_:1})]),_:1}),e(re,{ref_key:"refConfirmDelete",ref:s,onSubmit:i},{text:t(()=>[$e,Ce,m(" 您将要废弃"),_("span",De,g(p.question),1),Pe,m(" 确定要继续吗？ ")]),_:1},512),e(xe,{ref_key:"createQAPaneRef",ref:r,intentId:Y(f),onSubmit:a},null,8,["intentId"])],64)}}}),Te=S({__name:"SelectIntentionList",props:{intentId:{default:""}},emits:["onSelect"],setup(c,{emit:y}){const f=c,u=y,n=$({keyword:""}),r=$({list:[],total:0}),o=x(),s=x(),p=async(i={})=>{const[d,a]=await F.get({url:`/intent/${f.intentId}/document/list`,showLoading:o.value.el,data:{...n,...i}});a?(r.list=a.list||[],r.total=a.total):(r.list=[],r.total=0)},k=()=>{o.value.query({page:1})},P=i=>{u("onSelect",i)};return M(()=>{k()}),(i,d)=>{const a=V("el-table-column"),b=V("TableWithPager");return Q(),H(W,{class:"my-0",ref_key:"contentRef",ref:s},{default:t(()=>[e(I,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[e(N,{modelValue:n.keyword,"onUpdate:modelValue":d[0]||(d[0]=h=>n.keyword=h),label:"请输入关键字","hide-details":"",clearable:"",onKeyup:j(k,["enter"]),"onClick:clear":k},null,8,["modelValue","onKeyup"])]),_:1}),e(I,{cols:"12"},{default:t(()=>[e(b,{"row-class-name":"cursor-pointer",onRowClick:P,onQuery:p,ref_key:"tableWithPagerRef",ref:o,infos:r,height:"400px"},{default:t(()=>[e(a,{label:"标准问法",prop:"question","show-overflow-tooltip":""}),e(a,{label:"答案",prop:"output","show-overflow-tooltip":""}),e(a,{label:"意图",prop:"intent","show-overflow-tooltip":""})]),_:1},8,["infos"])]),_:1})]),_:1},512)}}}),Ye={class:"d-flex align-center"},Fe={class:"line1 flex-1"},Se=S({__name:"MarkList",setup(c){const y=L(),{intentId:f}=y.query,u=$({keyword:""}),n=$({list:[],total:0}),r=x(),o=x(),s=x(!1),p=$({annotationId:""}),k=async(h={})=>{const[q,l]=await F.get({url:`/intent/${f}/annotation/list`,showLoading:r.value.el,data:{...u,...h}});l?(n.list=l.list||[],n.total=l.total):(n.list=[],n.total=0)},P=()=>{r.value.query({page:1})},i=()=>{r.value.query()},d=h=>{p.annotationId=h,o.value.show({showActions:!1})},a=async h=>{const[q,l]=await F.post({showLoading:o.value.getContentEl(),showSuccess:!0,url:`/intent/${f}/annotation/${p.annotationId}/mark`,data:{documentId:h.documentId}});l&&(o.value.hide(),i())},b=async({res:h})=>{if(h){s.value=!0;const[q,l]=await F.post({showSuccess:!0,url:`/intent/${f}/annotation/create`,data:{fileId:h.fileId}});l&&P(),s.value=!1}};return M(()=>{i()}),(h,q)=>{const l=V("ButtonsInForm"),w=V("el-table-column"),T=V("TableWithPager"),C=V("Dialog");return Q(),K(E,null,[e(W,null,{default:t(()=>[e(I,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[e(N,{modelValue:u.keyword,"onUpdate:modelValue":q[0]||(q[0]=D=>u.keyword=D),label:"请输入关键字","hide-details":"",clearable:"",onKeyup:j(P,["enter"]),"onClick:clear":P},null,8,["modelValue","onKeyup"])]),_:1}),e(I,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[e(l,null,{default:t(()=>[e(ie,{"file-type":["text/csv"],onAfterUpload:b},{trigger:t(({loading:D})=>[e(oe,{loading:D||s.value,color:"primary"},{default:t(()=>[m("导入")]),_:2},1032,["loading"])]),_:1})]),_:1})]),_:1}),e(I,{cols:"12"},{default:t(()=>[e(T,{onQuery:k,ref_key:"tableWithPagerRef",ref:r,infos:n},{default:t(()=>[e(w,{label:"问题",prop:"question","min-width":"200px","show-overflow-tooltip":""}),e(w,{label:"答案",prop:"output","min-width":"200px","show-overflow-tooltip":""}),e(w,{label:"意图","min-width":"200px"},{default:t(({row:D})=>[_("div",Ye,[_("div",Fe,g(D.intent),1),e(Y(ce),{onClick:O=>d(D.annotationId),"stroke-width":"1.5",size:20,class:"text-primary cursor-pointer"},null,8,["onClick"])])]),_:1}),e(w,{label:"更新时间","min-width":"200px"},{default:t(({row:D})=>[m(g(Y(A).dateFormat(D.updatedAt,"YYYY-MM-DD HH:mm:ss")),1)]),_:1}),e(w,{label:"操作人",prop:"operator","min-width":"220px"})]),_:1},8,["infos"])]),_:1})]),_:1}),e(C,{ref_key:"selectIntentionRef",ref:o,persistent:"","max-width":"1200px","retain-focus":!1},{title:t(()=>[m(" 选择意图 ")]),default:t(()=>[e(Te,{intentId:Y(f),onOnSelect:a},null,8,["intentId"])]),_:1},512)],64)}}}),Ne=S({__name:"intentionMarkDetail",setup(c){const y=L(),{intentId:f}=y.query,u=x({}),n=x(""),r=async()=>{let[o,s]=await F.get({showLoading:!0,url:`/intent/${f}`});s&&(u.value=s)};return M(()=>{r()}),(o,s)=>(Q(),K(E,null,[e(ne,{backUrl:"/sample-library/intention-mark/list"},{default:t(()=>[m("意图模型标注详情")]),_:1}),e(Z,{class:"mt-4"},{header:t(()=>[m(" 名称："+g(u.value.name),1)]),default:t(()=>[e(ye,{info:u.value},null,8,["info"])]),_:1}),e(Z,{class:"mt-5"},{header:t(()=>[e(de,{modelValue:n.value,"onUpdate:modelValue":s[0]||(s[0]=p=>n.value=p),"align-tabs":"start",color:"primary"},{default:t(()=>[e(G,{value:1},{default:t(()=>[m("问答")]),_:1}),e(G,{value:2},{default:t(()=>[m("标注")]),_:1})]),_:1},8,["modelValue"])]),default:t(()=>[e(ue,{modelValue:n.value,"onUpdate:modelValue":s[1]||(s[1]=p=>n.value=p)},{default:t(()=>[e(J,{class:"pt-2",value:1},{default:t(()=>[e(qe)]),_:1}),e(J,{class:"pt-2",value:2},{default:t(()=>[e(Se)]),_:1})]),_:1},8,["modelValue"])]),_:1})],64))}});export{Ne as default};
