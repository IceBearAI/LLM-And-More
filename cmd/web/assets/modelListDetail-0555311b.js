import{_ as Te}from"./NavBack.vue_vue_type_script_setup_true_lang-5ac0fb78.js";import{ac as ce,i as Ce,c as me,o as pe,U as C,k as c,l as b,m as e,j as a,_ as i,$ as f,n as x,Y as M,W as n,aB as _e,al as ee,am as ae,d as W,au as te,x as A,r as w,aC as Z,av as E,K as De,Z as F,a5 as Me,F as Y,z as fe,a0 as se,aD as ne,D as re,a8 as de}from"./utils-f1e2951f.js";import{_ as ie}from"./UiParentCard.vue_vue_type_script_setup_true_lang-cae299fc.js";import{_ as H,ae as G,e as $e,V as J,a5 as z,ai as Pe}from"./index-7a249bbf.js";import{V as D}from"./VCol-61c9553c.js";import{V as O}from"./VRow-276356c1.js";import{C as Se}from"./CustomUpload-c04deeaa.js";import{_ as Ue}from"./Explain.vue_vue_type_style_index_0_lang-c9b62320.js";import{V as Be}from"./VTextarea-aef5f788.js";import{V as Le,a as Ne,b as Re,c as Ge}from"./VExpansionPanel-3306c60f.js";import{V as Ee,a as ue}from"./VRadioGroup-8c710edb.js";import{V as Ae}from"./VForm-e8a0f729.js";import{i as Fe}from"./index-8cd50de6.js";import{V as X}from"./VAlert-a0281362.js";import{_ as je}from"./ConfirmByInput.vue_vue_type_style_index_0_lang-fda17e11.js";import{_ as ve}from"./ConfirmByClick.vue_vue_type_style_index_0_lang-7ae45c45.js";import{_ as ze}from"./DialogLog.vue_vue_type_style_index_0_lang-7f481b87.js";import{I as qe}from"./IconTerminal2-4d9440d1.js";import{V as Ye,a as Je,b as Oe,c as We}from"./VWindowItem-42ab308b.js";import"./IconInfoCircle-692a5cf4.js";import"./Confirm-7827dd76.js";import"./TextLog-e45811f5.js";const j=g=>(ee("data-v-11edd06b"),g=g(),ae(),g),He=j(()=>n("label",null,"供应",-1)),Qe=j(()=>n("label",null,"类型",-1)),Ke=j(()=>n("label",null,"最长上下文",-1)),Ze=j(()=>n("label",null,"微调",-1)),Xe=j(()=>n("label",null,"参数量",-1)),ea={style:{color:"#539bff"}},aa=j(()=>n("label",null,"创建时间",-1)),ta=j(()=>n("label",null,"备注",-1)),la={__name:"ModelListDetailBaseInfo",setup(g){const{loadDictTree:U,getLabels:y}=ce(),s=Ce("provideModelListDetail"),m=me(()=>s.rawData),o=async()=>{await U(["model_type"])};return pe(()=>{o()}),(t,$)=>{const V=C("router-link"),P=C("el-tooltip");return c(),b(O,{class:"my-form waterfall"},{default:e(()=>[a(D,{xs:"12",sm:"6",md:"4",lg:"3"},{default:e(()=>[a(G,{"hide-details":""},{prepend:e(()=>[He]),default:e(()=>[i(" "+f(m.value.providerName),1)]),_:1})]),_:1}),a(D,{xs:"12",sm:"6",md:"4",lg:"3"},{default:e(()=>[a(G,{"hide-details":""},{prepend:e(()=>[Qe]),default:e(()=>[i(" "+f(x(y)([["model_type",m.value.modelType]])),1)]),_:1})]),_:1}),a(D,{xs:"12",sm:"6",md:"4",lg:"3"},{default:e(()=>[a(G,{"hide-details":""},{prepend:e(()=>[Ke]),default:e(()=>[i(" "+f(m.value.maxTokens),1)]),_:1})]),_:1}),m.value.isFineTuning?(c(),b(D,{key:0,xs:"12",sm:"6",md:"4",lg:"3"},{default:e(()=>[a(G,{"hide-details":""},{prepend:e(()=>[Ze]),default:e(()=>[a(P,{content:"微调详情",placement:"top"},{default:e(()=>[a(V,{to:"/model/fine-tuning/detail?jobId="+m.value.jobId,class:"link"},{default:e(()=>[i(f(m.value.isFineTuning?"是":""),1)]),_:1},8,["to"])]),_:1})]),_:1})]),_:1})):M("",!0),a(D,{xs:"12",sm:"6",md:"4",lg:"3"},{default:e(()=>[a(G,{"hide-details":""},{prepend:e(()=>[Xe]),default:e(()=>[n("span",ea,f(m.value.parameters)+"B",1)]),_:1})]),_:1}),a(D,{xs:"12",sm:"6",md:"4",lg:"3"},{default:e(()=>[a(G,{"hide-details":""},{prepend:e(()=>[aa]),default:e(()=>[i(" "+f(x(_e).dateFormat(m.value.createdAt,"YYYY-MM-DD HH:mm:ss")),1)]),_:1})]),_:1}),a(D,{xs:"12",sm:"6",md:"4",lg:"3"},{default:e(()=>[a(G,{"hide-details":""},{prepend:e(()=>[ta]),default:e(()=>[i(" "+f(m.value.remark),1)]),_:1})]),_:1})]),_:1})}}},oa=H(la,[["__scopeId","data-v-11edd06b"]]),N=g=>(ee("data-v-63404a38"),g=g(),ae(),g),sa={class:"mx-auto mt-3",style:{width:"540px"}},na=N(()=>n("label",{class:"required"},"评测指标",-1)),ra=N(()=>n("label",{class:"required"},"待评测数据集",-1)),da=N(()=>n("label",{class:"required"},"最大输出序列长度",-1)),ia=N(()=>n("label",{class:"required"},"单卡Batch大小",-1)),ua=N(()=>n("label",null,"备注",-1)),ca=N(()=>n("label",null,"调度标签",-1)),ma=N(()=>n("label",null,"k8s集群",-1)),pa=N(()=>n("label",null,"推理类型",-1)),_a=N(()=>n("label",{class:"required"},"CPU数量",-1)),fa=N(()=>n("label",{class:"required"},"GPU数量",-1)),va=W({__name:"CreatePerformanceEvalPane",emits:["submit"],setup(g,{expose:U,emit:y}){const s=te(),m=A({operateType:"add"}),o=w(""),t=A({modelId:Number(s.query.jobId),fileId:"",evalTargetType:null,maxLength:512,batchSize:32,remark:"",label:null,k8sCluster:null,inferredType:"",cpu:0,gpu:0,maxGpuMemory:""}),$=y,V=w(),P=w(),k=A({fileId:[l=>!!l||"请选择微调文件"],evalTargetType:[l=>!!l||"请选择评测指标"],maxLength:[l=>!!l||"请输入最大输出序列长度"],batchSize:[l=>!!l||"请输入单卡Batch大小"],cpu:[l=>Z.validNumberInput(l,0,100,"请输入使用CPU数量",!0)],gpu:[l=>Z.validNumberInput(l,0,20,"请输入使用GPU数量",!0)],maxGpuMemory:[l=>Z.validNumberInput(l,1,80,"",!0)]}),T=({res:l})=>{l&&(t.fileId=l.fileId,o.value=l.filename)},p=()=>{o.value="",t.fileId=""},u=()=>{t.cpu!==1&&(t.cpu=1),t.gpu!==1&&(t.gpu=1)},h=async({valid:l,errors:r,showLoading:B})=>{if(l){const L={...t};t.inferredType==="cpu"?L.gpu=0:L.cpu=0,(L.gpu<2||!L.maxGpuMemory)&&delete L.maxGpuMemory;const[_,Q]=await E.post({showLoading:B,showSuccess:!0,url:"/evaluate/create",data:L});Q&&(V.value.hide(),$("submit"))}};return U({show({title:l,operateType:r}){V.value.show({title:l,refForm:P}),m.operateType=r,r=="add"&&(p(),t.evalTargetType=null,t.maxLength=512,t.batchSize=32,t.remark="",t.label=null,t.k8sCluster=null,t.inferredType="",t.cpu=0,t.gpu=0,t.maxGpuMemory="")}}),(l,r)=>{const B=C("Select"),L=C("Pane");return c(),b(L,{ref_key:"refPane",ref:V,onSubmit:h},{default:e(()=>[n("div",sa,[a(Ae,{ref_key:"refForm",ref:P,class:"my-form"},{default:e(()=>[a(B,{placeholder:"请选择评测指标",rules:k.evalTargetType,mapDictionary:{code:"model_evaluate_target_type"},modelValue:t.evalTargetType,"onUpdate:modelValue":r[0]||(r[0]=_=>t.evalTargetType=_)},{prepend:e(()=>[na]),_:1},8,["rules","modelValue"]),t.evalTargetType!=="five"?(c(),b(G,{key:0,rules:k.fileId,modelValue:t.fileId,"onUpdate:modelValue":r[1]||(r[1]=_=>t.fileId=_),"hide-details":"auto"},{prepend:e(()=>[ra]),default:e(()=>[o.value?(c(),b($e,{key:0,closable:"",color:"info","onClick:close":p},{default:e(()=>[i(f(o.value),1)]),_:1})):(c(),b(Se,{key:1,"file-type":[".txt",".json",".jsonl"],isSuffixValid:"",onAfterUpload:T},{trigger:e(()=>[a(J,{color:"info",variant:"outlined"},{default:e(()=>[i("上传文件")]),_:1})]),_:1},8,["file-type"]))]),_:1},8,["rules","modelValue"])):M("",!0),a(z,{type:"number",placeholder:"请输入最大输出序列长度","hide-details":"auto",rules:k.maxLength,modelValue:t.maxLength,"onUpdate:modelValue":r[2]||(r[2]=_=>t.maxLength=_),modelModifiers:{number:!0}},{prepend:e(()=>[da]),_:1},8,["rules","modelValue"]),a(z,{type:"number",placeholder:"请输入单卡Batch大小","hide-details":"auto",rules:k.batchSize,modelValue:t.batchSize,"onUpdate:modelValue":r[3]||(r[3]=_=>t.batchSize=_),modelModifiers:{number:!0}},{prepend:e(()=>[ia]),_:1},8,["rules","modelValue"]),a(Be,{modelValue:t.remark,"onUpdate:modelValue":r[4]||(r[4]=_=>t.remark=_),modelModifiers:{trim:!0},placeholder:"请输入你微调模型的备注",clearable:""},{prepend:e(()=>[ua]),_:1},8,["modelValue"]),a(G,null,{default:e(()=>[a(Le,null,{default:e(()=>[a(Ne,{elevation:"10"},{default:e(()=>[a(Re,{class:"text-h6"},{default:e(()=>[i("高级")]),_:1}),a(Ge,{class:"mt-4",eager:""},{default:e(()=>[a(B,{placeholder:"请选择调度标签","hide-details":!1,mapDictionary:{code:"model_deploy_label"},modelValue:t.label,"onUpdate:modelValue":r[5]||(r[5]=_=>t.label=_)},{prepend:e(()=>[ca]),_:1},8,["modelValue"]),a(B,{placeholder:"请选择k8s集群","hide-details":!1,mapDictionary:{code:"k8s_cluster"},modelValue:t.k8sCluster,"onUpdate:modelValue":r[6]||(r[6]=_=>t.k8sCluster=_)},{prepend:e(()=>[ma]),_:1},8,["modelValue"]),a(Ee,{modelValue:t.inferredType,"onUpdate:modelValue":[r[7]||(r[7]=_=>t.inferredType=_),u],inline:"",color:"primary"},{prepend:e(()=>[pa]),default:e(()=>[a(ue,{label:"CPU",value:"cpu"}),a(ue,{label:"GPU",value:"gpu"})]),_:1},8,["modelValue"]),t.inferredType==="cpu"?(c(),b(z,{key:0,type:"number",placeholder:"请输入使用CPU数量",rules:k.cpu,modelValue:t.cpu,"onUpdate:modelValue":r[8]||(r[8]=_=>t.cpu=_),modelModifiers:{number:!0}},{prepend:e(()=>[_a]),_:1},8,["rules","modelValue"])):M("",!0),t.inferredType==="gpu"?(c(),b(z,{key:1,type:"number",placeholder:"请输入使用GPU数量",rules:k.gpu,modelValue:t.gpu,"onUpdate:modelValue":r[9]||(r[9]=_=>t.gpu=_),modelModifiers:{number:!0}},{prepend:e(()=>[fa]),_:1},8,["rules","modelValue"])):M("",!0),t.gpu>1?(c(),b(z,{key:2,type:"number",placeholder:"请输入GPU内存",rules:k.maxGpuMemory,modelValue:t.maxGpuMemory,"onUpdate:modelValue":r[10]||(r[10]=_=>t.maxGpuMemory=_),modelModifiers:{number:!0},max:"80","hide-details":"auto"},{prepend:e(()=>[n("label",null,[i("GPU内存 "),a(Ue,null,{default:e(()=>[i("指定每个 GPU 用于存储模型权重的最大内存。这允许它为激活分配更多内存，因此您可以使用更长的上下文长度或更大的批量大小")]),_:1})])]),"append-inner":e(()=>[i(" GiB ")]),_:1},8,["rules","modelValue"])):M("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},512)])]),_:1},512)}}});const ya=H(va,[["__scopeId","data-v-63404a38"]]);const ha={__name:"GradeRadarChart",setup(g,{expose:U}){const y=w();var s=null;const m=({title:o,radar:t,seriesData:$})=>{s=Fe(y.value);const V=$.map(P=>P.name);s.setOption({title:{text:o},legend:{icon:"circle",data:V},radar:t,series:[{type:"radar",data:$}]})};return De(()=>{s&&(s.dispose(),s=null)}),Pe(y,o=>{s==null||s.resize()}),U({initChart:m}),(o,t)=>(c(),F("div",{ref_key:"refChart",ref:y,class:"chart-item w-100 h-100"},null,512))}},ba=H(ha,[["__scopeId","data-v-8ceb45d1"]]),ga=g=>(ee("data-v-33a4948e"),g=g(),ae(),g),xa={style:{height:"500px"}},ka=ga(()=>n("h5",{class:"text-h6 text-capitalize"},"建议进一步操作",-1)),Va={class:"text-center mt-1"},Ia=W({__name:"ViewEvalDetailPane",setup(g,{expose:U}){const y=w(),s=w(),m=A({currentModelId:null,compare1ModelId:null,compare2ModelId:null}),o=w({}),t=[{key:"current",value:"currentModelId",disabled:!0},{key:"compare1",value:"compare1ModelId",disabled:!1},{key:"compare2",value:"compare2ModelId",disabled:!1}],$=A({id:""}),V=me(()=>o.value.current&&(o.value.current.riskOver||o.value.current.riskUnder)),P=()=>{const T={indicator:[{name:"中文能力",max:10,axisLabel:{show:!0}},{name:"推理能力",max:10},{name:"指令遵从能力",max:10},{name:"创新能力",max:10},{name:"阅读理解",max:10}]},p=[];o.value&&t.forEach(u=>{o.value[u.key].value&&p.push({name:o.value[u.key].name,value:o.value[u.key].value})}),s.value.initChart({title:"",radar:T,seriesData:p})},k=async(T=!1)=>{if(T)return;const[p,u]=await E.post({url:"/evaluate/fivegraph",showLoading:y.value.el,data:{currentModelId:m.currentModelId,compare1ModelId:m.compare1ModelId,compare2ModelId:m.compare2ModelId,currentModelEvaluateId:$.id}});u&&(o.value=u,P())};return U({show({title:T,modelId:p,id:u}){y.value.show({width:900,title:T,hasSubmitBtn:!1}),m.currentModelId=parseInt(p),m.compare1ModelId=null,m.compare2ModelId=null,$.id=u,k()}}),(T,p)=>{const u=C("Select"),h=C("Pane");return c(),b(h,{ref_key:"refPane",ref:y},{default:e(()=>[a(O,null,{default:e(()=>[a(D,{cols:V.value?7:12},{default:e(()=>[n("div",xa,[a(ba,{ref_key:"gradeRadarChartRef",ref:s},null,512)])]),_:1},8,["cols"]),V.value?(c(),b(D,{key:0,cols:"5"},{default:e(()=>[o.value.current.riskOver?(c(),b(X,{key:0,type:o.value.current.riskOver?"error":"success",variant:"tonal"},{default:e(()=>[i("过拟合风险")]),_:1},8,["type"])):M("",!0),o.value.current.riskUnder?(c(),b(X,{key:1,type:o.value.current.riskUnder?"error":"success",variant:"tonal",class:"mt-4"},{default:e(()=>[i("欠拟合风险")]),_:1},8,["type"])):M("",!0),a(X,{type:"info",variant:"tonal",class:"mt-4"},{default:e(()=>[ka,n("div",null,f(o.value.current.remind),1)]),_:1})]),_:1})):M("",!0),a(D,{cols:"12"},{default:e(()=>[a(O,null,{default:e(()=>[(c(),F(Y,null,Me(t,l=>a(D,{cols:"4"},{default:e(()=>{var r;return[a(u,{placeholder:"请选择模型",modelValue:m[l.value],"onUpdate:modelValue":B=>m[l.value]=B,disabled:l.disabled,clearable:!1,mapAPI:{url:"/channels/models",data:{pageSize:-1,providerName:"LocalAI",modelType:"text-generation",evalTag:"five"},labelField:"modelName",valueField:"id"},onChange:B=>k(l.disabled)},null,8,["modelValue","onUpdate:modelValue","disabled","onChange"]),n("div",Va,f((r=o.value[l.key])==null?void 0:r.score),1)]}),_:2},1024)),64))]),_:1})]),_:1})]),_:1})]),_:1},512)}}});const wa=H(Ia,[["__scopeId","data-v-33a4948e"]]),Ta={class:""},Ca={class:"d-flex"},Da={style:{width:"250px"},class:"mr-4"},Ma={style:{width:"250px"}},$a=n("span",null,"请先部署模型 ",-1),Pa={key:1,class:"d-flex align-center justify-center"},Sa=["onClick"],Ua=["onClick"],Ba=n("span",{class:"text-primary"},"取消",-1),La=n("br",null,null,-1),Na={class:"text-primary font-weight-black"},Ra=n("br",null,null,-1),Ga=W({__name:"TabModelEstimate",props:{showArrange:String,modelTitle:String,providerName:String},setup(g){const U=te(),{modelName:y,jobId:s}=U.query,{loadDictTree:m,getLabels:o}=ce(),t=w(),$=w(),V=w(),P=w(),k=w(),T=w(),p=A({style:{},formData:{modelName:"",evalTargetType:""},showTooltip:!1,timer:null,tableInfos:{list:[],total:0},currentJobId:""}),u=A({status:null,evalTargetType:null}),h=A({uuid:null}),l=w();fe(p);const r=()=>{$.value.show({title:"性能评估",operateType:"add"})},B=v=>{V.value.show({title:"详情",id:v.id,modelId:s})},L=v=>{p.currentJobId=v.uuid,k.value.show({width:"450px",confirmText:p.currentJobId})},_=v=>{h.uuid=v.uuid,T.value.show({width:"450px"})},Q=async(v={})=>{const[I,S]=await E.delete({...v,showSuccess:!0,url:`/evaluate/delete/${h.uuid}`});S&&(T.value.hide(),oe())},ye=async(v={})=>{const[I,S]=await E.put({...v,showSuccess:!0,url:`/evaluate/cancel/${p.currentJobId}`});S&&(k.value.hide(),oe())},le=async(v={})=>{await m(["model_evaluate_data_type"]);const[I,S]=await E.get({url:"/evaluate/list",showLoading:t.value.el,data:{modelId:s,...u,...v}});S?(p.tableInfos.total=S.total,p.tableInfos.list=S.list||[]):(p.tableInfos.list=[],p.tableInfos.total=0)},K=()=>{t.value.query({page:1})},oe=()=>{t.value.query()},he=v=>{let I=[];return v.status=="waiting"||v.status=="running"?I.push({text:"取消",color:"",click(){L(v)}}):I.push({text:"删除",color:"error",click(){_(v)}}),I},be=async v=>{p.currentJobId=v.uuid,l.value.show()},ge=async()=>{let[v,I]=await E.get({url:`/api/evaluate/${y}/eval-log/${p.currentJobId}`});if(I){const S=Object.keys(I).length===0?"":I;l.value.setContent(S)}};return pe(()=>{le()}),(v,I)=>{const S=C("Select"),q=C("el-tooltip"),xe=C("ButtonsInForm"),R=C("el-table-column"),ke=C("router-link"),Ve=C("ButtonsInTable"),Ie=C("TableWithPager");return c(),F(Y,null,[n("div",Ta,[a(O,null,{default:e(()=>[a(D,{cols:"12",class:"d-flex justify-space-between align-center",style:{height:"76px"}},{default:e(()=>[n("div",Ca,[n("div",Da,[a(S,{onChange:K,label:"请选择评估状态",mapDictionary:{code:"model_eval_status"},modelValue:u.status,"onUpdate:modelValue":I[0]||(I[0]=d=>u.status=d)},null,8,["modelValue"])]),n("div",Ma,[a(S,{onChange:K,label:"请选择指标",mapDictionary:{code:"model_evaluate_target_type"},modelValue:u.evalTargetType,"onUpdate:modelValue":I[1]||(I[1]=d=>u.evalTargetType=d)},null,8,["modelValue"])])]),a(q,{ref:"tooltipRef",visible:p.showTooltip,"popper-options":{modifiers:[{name:"computeStyles",options:{adaptive:!1,enabled:!1}}]},"auto-close":1,"virtual-ref":P.value,"virtual-triggering":"","popper-class":"singleton-tooltip"},{content:e(()=>[$a]),_:1},8,["visible","virtual-ref"]),a(xe,null,{default:e(()=>[g.providerName==="LocalAI"?(c(),b(J,{key:0,color:"primary",onClick:r},{default:e(()=>[i("创建评估")]),_:1})):M("",!0)]),_:1})]),_:1}),a(D,{cols:"12"},{default:e(()=>[a(Ie,{onQuery:le,ref_key:"refTableWithPager",ref:t,infos:p.tableInfos},{default:e(()=>[a(R,{label:"指标","min-width":"100px"},{default:e(({row:d})=>[i(f(x(o)([["model_evaluate_target_type",d.evalTargetType]])),1)]),_:1}),a(R,{label:"评估状态","min-width":"120px"},{default:e(({row:d})=>[d.status==="failed"?(c(),b(q,{key:0,content:d.statusMsg,placement:"top","raw-content":""},{default:e(()=>[n("span",{class:se(`text-${x(ne).statusMap[d.status].color}`)},f(x(o)([["model_eval_status",d.status]])),3)]),_:2},1032,["content"])):(c(),F("div",Pa,[n("span",{class:se(`text-${x(ne).statusMap[d.status].color}`)},f(x(o)([["model_eval_status",d.status]])),3),["running","success"].includes(d.status)?(c(),F("div",{key:0,class:"link ml-1",onClick:we=>be(d)},"(日志)",8,Sa)):M("",!0)]))]),_:1}),a(R,{label:"webshell","min-width":"90px"},{default:e(({row:d})=>[d.status==="running"?(c(),b(q,{key:0,content:"进入终端",placement:"top"},{default:e(()=>[a(ke,{class:"link",to:{path:"/model/terminal",query:{resourceType:"eval-job",serviceName:d.jobName}},target:"_blank"},{default:e(()=>[a(x(qe),{class:"align-top",size:20})]),_:2},1032,["to"])]),_:2},1024)):M("",!0)]),_:1}),a(R,{label:"数据量","min-width":"100px"},{default:e(({row:d})=>[i(f(d.dataSize),1)]),_:1}),a(R,{label:"评估数据集","min-width":"120px"},{default:e(({row:d})=>[i(f(x(o)([["model_evaluate_data_type",d.dataType]])),1)]),_:1}),a(R,{label:"平均分","min-width":"100px"},{default:e(({row:d})=>[d.evalTargetType==="five"&&d.score>0?(c(),b(q,{key:0,content:"点击可查看五维图指标详情",placement:"top"},{default:e(()=>[n("span",{class:"link",onClick:we=>B(d)},f(d.score),9,Ua)]),_:2},1024)):(c(),F(Y,{key:1},[i(f(d.score),1)],64))]),_:1}),a(R,{label:"备注","min-width":"200px","show-overflow-tooltip":""},{default:e(({row:d})=>[i(f(d.remark),1)]),_:1}),a(R,{label:"创建时间","min-width":"160px"},{default:e(({row:d})=>[i(f(x(_e).dateFormat(d.createdAt,"YYYY-MM-DD HH:mm:ss")),1)]),_:1}),a(R,{label:"操作",width:"80px",fixed:"right"},{default:e(({row:d})=>[a(Ve,{buttons:he(d),onlyOne:""},null,8,["buttons"])]),_:1})]),_:1},8,["infos"])]),_:1})]),_:1})]),a(ze,{ref_key:"refDialogLog",ref:l,interval:20,onRefresh:ge},null,512),a(je,{ref_key:"refConfirmAbort",ref:k,onSubmit:ye},{text:e(()=>[i(" 此操作将会"),Ba,i("正在进行的模型评估"),La,i(" 任务ID："),n("span",Na,f(p.currentJobId),1),Ra,i(" 你还要继续吗？ ")]),_:1},512),a(ve,{ref_key:"refConfirmDelete",ref:T,onSubmit:Q},{text:e(()=>[i("确定要删除该评估数据？")]),_:1},512),a(ya,{ref_key:"createPerformanceEvalPaneRef",ref:$,onSubmit:K},null,512),a(wa,{ref_key:"viewEvalDetailPaneRef",ref:V},null,512)],64)}}});const Ea=["innerHTML"],dt=W({__name:"modelListDetail",setup(g){const U=te(),y=w(),s=A({tabIndex:"2",style:{},formData:{},rawData:{modelName:"",deployStatus:"",providerName:""},confirmByClickInfo:{html:"",action:"",row:{}}}),{style:m,rawData:o,formData:t}=fe(s);re("provideModelListDetail",s),re("provideModelListDetailed",s),(async()=>{let{jobId:u}=U.query,[h,l]=await E.get({showLoading:!0,url:`/api/models/${u}`});l&&(s.rawData=l)})();const V=(u={})=>{let{action:h,row:l}=s.confirmByClickInfo;h=="deploy"?P(l,u):h=="undeploy"&&k(l,u)},P=async(u,h)=>{let[l,r]=await E.post({...h,showSuccess:!0,url:`/api/models/${u.id}/deploy`,data:{...s.formData,id:u.id}});r&&y.value.hide()},k=async(u,h)=>{let[l,r]=await E.post({...h,showSuccess:!0,url:`/api/models/${u.id}/undeploy`,data:{...s.formData,id:u.id}});r&&y.value.hide()},T=()=>{de.assign(s.confirmByClickInfo,{html:"确认部署模型 <span class='text-primary mx-1  font-weight-black'>"+s.rawData.modelName+"</span>吗？",action:"deploy",row:s.rawData}),y.value.show({width:"350px"})},p=()=>{de.assign(s.confirmByClickInfo,{html:"确认卸载模型 <span class='text-primary mx-1  font-weight-black'>"+s.rawData.modelName+"</span>吗？",action:"undeploy",row:s.rawData}),y.value.show({width:"350px"})};return(u,h)=>(c(),F(Y,null,[a(Te,{backUrl:"/model/model-list/list"},{default:e(()=>[i("模型详情")]),_:1}),a(ie,{class:"mt-4"},{header:e(()=>[i(" 模型："+f(x(o).modelName),1)]),action:e(()=>[x(o).deployStatus=="success"||x(o).deployStatus=="running"?(c(),b(J,{key:0,flat:"",color:"secondary",onClick:p},{default:e(()=>[i("卸载")]),_:1})):M("",!0),x(o).deployStatus=="failed"?(c(),b(J,{key:1,flat:"",color:"secondary",onClick:T},{default:e(()=>[i("部署")]),_:1})):M("",!0)]),default:e(()=>[a(oa)]),_:1}),a(ie,{class:"mt-5"},{header:e(()=>[a(Ye,{modelValue:s.tabIndex,"onUpdate:modelValue":h[0]||(h[0]=l=>s.tabIndex=l),"align-tabs":"start",color:"primary"},{default:e(()=>[a(Je,{value:2},{default:e(()=>[i("当前模型下的评估列表")]),_:1})]),_:1},8,["modelValue"])]),default:e(()=>[a(Oe,{modelValue:s.tabIndex,"onUpdate:modelValue":h[1]||(h[1]=l=>s.tabIndex=l)},{default:e(()=>[a(We,{value:2},{default:e(()=>[a(Ga,{showArrange:x(o).deployStatus,modelTitle:x(o).modelName,providerName:x(o).providerName},null,8,["showArrange","modelTitle","providerName"])]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(ve,{ref_key:"refConfirmByClick",ref:y,onSubmit:V},{text:e(()=>[n("div",{innerHTML:s.confirmByClickInfo.html},null,8,Ea)]),_:1},512)],64))}});export{dt as default};
