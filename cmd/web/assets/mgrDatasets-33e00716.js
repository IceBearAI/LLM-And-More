import{d as R,x as V,r as b,aC as Y,U as v,k,l as $,m as a,W as n,j as e,_ as r,$ as T,av as U,al as A,am as K,au as E,o as H,S as z,Z as q,aA as L,Q as O,n as Z,aB as G,F as J}from"./utils-7cd8a09b.js";import{_ as X}from"./BaseBreadcrumb.vue_vue_type_style_index_0_lang-c9cba6c3.js";import{_ as ee}from"./UiParentCard.vue_vue_type_script_setup_true_lang-d71eddbc.js";import{C as te}from"./CustomUpload-66947653.js";import{_ as ae}from"./Explain.vue_vue_type_style_index_0_lang-ac56cfd0.js";import{ae as le,e as oe,V as Q,a5 as P,_ as se}from"./index-2a19813c.js";import{V as re}from"./VTextarea-4601df95.js";import{V as ne}from"./VForm-a8874399.js";import{_ as ie}from"./ConfirmByInput.vue_vue_type_style_index_0_lang-074f0dad.js";import{V as de}from"./VRow-6e3b9bcc.js";import{V as F}from"./VCol-3d7d5d87.js";import"./IconInfoCircle-ea955826.js";import"./Confirm-f7c8f790.js";const C=w=>(A("data-v-e14f00ba"),w=w(),K(),w),ue={class:"mx-auto mt-3",style:{width:"540px"}},me={class:"required"},pe=C(()=>n("label",{class:"required"},"样本名称",-1)),ce=C(()=>n("label",null,"分隔符",-1)),fe=C(()=>n("label",null,"分割值",-1)),_e=C(()=>n("label",null,"备注",-1)),he=C(()=>n("div",{class:"d-flex justify-center textPrimary"},[r(" 点击 "),n("a",{class:"link mx-1",href:"/assets/file/mgr-datasets.txt",download:"demo.txt"},"下载"),r(" 数据集模板 ")],-1)),be=R({__name:"CreateSamplePane",emits:["submit"],setup(w,{expose:S,emit:D}){const g=V({operateType:"add"}),t=V({file:null,name:"",splitType:"",splitMax:"",remark:""}),m=D,y=b(),p=b(),c=V({file:[o=>!!o||"请上传样本文件"],name:[o=>!!o||"请输入样本名称"],splitMax:[o=>Y.validNumberInput(o,0,2e3,"",!0)]}),x=o=>{t.file=o},B=()=>{t.file=null},I=async({valid:o,showLoading:l})=>{if(o){const i={url:"",method:""};g.operateType=="add"&&(i.url="/mgr/datasets/create",i.method="upload");const[s,M]=await U[i.method]({showLoading:l,showSuccess:!0,url:i.url,data:t});M&&(y.value.hide(),m("submit"))}};return S({show({title:o,operateType:l}){y.value.show({title:o,refForm:p}),g.operateType=l,g.operateType==="add"?(t.file=null,t.name="",t.splitType="",t.splitMax="",t.remark=""):console.log("edit")}}),(o,l)=>{const i=v("Pane");return k(),$(i,{ref_key:"refPane",ref:y,onSubmit:I},{default:a(()=>[n("div",ue,[e(ne,{ref_key:"refForm",ref:p,class:"my-form"},{default:a(()=>[e(le,{rules:c.file,modelValue:t.file,"onUpdate:modelValue":l[0]||(l[0]=s=>t.file=s),"hide-details":"auto"},{prepend:a(()=>[n("label",me,[r("样本文件 "),e(ae,null,{default:a(()=>[r("支持扩展名：.txt、.jsonl")]),_:1})])]),default:a(()=>[t.file?(k(),$(oe,{key:0,closable:"",color:"info","onClick:close":B},{default:a(()=>[r(T(t.file.name),1)]),_:1})):(k(),$(te,{key:1,"file-type":[".txt",".jsonl"],isSuffixValid:"",onBeforeUpload:x,"auto-upload":!1,"file-size":10},{trigger:a(()=>[e(Q,{color:"info",variant:"outlined"},{default:a(()=>[r("选择文件")]),_:1})]),_:1},8,["file-type"]))]),_:1},8,["rules","modelValue"]),e(P,{type:"text",placeholder:"请输入样本名称","hide-details":"auto",clearable:"",rules:c.name,modelValue:t.name,"onUpdate:modelValue":l[1]||(l[1]=s=>t.name=s)},{prepend:a(()=>[pe]),_:1},8,["rules","modelValue"]),e(P,{type:"text",placeholder:"请输入分隔符","hide-details":"auto",clearable:"",modelValue:t.splitType,"onUpdate:modelValue":l[2]||(l[2]=s=>t.splitType=s)},{prepend:a(()=>[ce]),_:1},8,["modelValue"]),e(P,{type:"number",placeholder:"请输入分割值",rules:c.splitMax,"hide-details":"auto",modelValue:t.splitMax,"onUpdate:modelValue":l[3]||(l[3]=s=>t.splitMax=s),modelModifiers:{number:!0}},{prepend:a(()=>[fe]),_:1},8,["rules","modelValue"]),e(re,{modelValue:t.remark,"onUpdate:modelValue":l[4]||(l[4]=s=>t.remark=s),modelModifiers:{trim:!0},placeholder:"备注",clearable:""},{prepend:a(()=>[_e]),_:1},8,["modelValue"])]),_:1},512),he])]),_:1},512)}}});const ye=se(be,[["__scopeId","data-v-e14f00ba"]]),xe=n("span",{class:"text-primary font-weight-black"},"删除",-1),Ve=n("br",null,null,-1),we={class:"text-primary font-weight-black"},ge=n("br",null,null,-1),qe=R({__name:"mgrDatasets",setup(w){const S=E(),D=b({title:"文本样本列表"}),g=b([{text:"样本库",disabled:!1,href:"#"},{text:"文本样本列表",disabled:!0,href:"#"}]),t=V({name:""}),m=V({list:[],total:0}),y=b(),p=b(),c=b(),x=V({id:""}),B=d=>{let f=[];return f.push({text:"删除",color:"error",click(){I(d)}}),f},I=d=>{x.id=d.uuid,c.value.show({width:"450px",confirmText:x.id})},o=async(d={})=>{const[f,_]=await U.delete({...d,showSuccess:!0,url:`/mgr/datasets/${x.id}`});_&&(c.value.hide(),s())},l=async(d={})=>{const[f,_]=await U.get({url:"/mgr/datasets/list",showLoading:p.value.el,data:{...t,...d}});_?(m.list=_.list||[],m.total=_.total):(m.list=[],m.total=0)},i=()=>{p.value.query({page:1})},s=()=>{p.value.query()},M=()=>{y.value.show({title:"上传样本",operateType:"add"})};return H(()=>{t.name=S.query.name,s()}),(d,f)=>{const _=v("ButtonsInForm"),h=v("el-table-column"),W=v("ButtonsInTable"),j=v("TableWithPager"),N=z("copy");return k(),q(J,null,[e(X,{title:D.value.title,breadcrumbs:g.value},null,8,["title","breadcrumbs"]),e(ee,null,{default:a(()=>[e(de,null,{default:a(()=>[e(F,{cols:"12",lg:"3",md:"4",sm:"6"},{default:a(()=>[e(P,{modelValue:t.name,"onUpdate:modelValue":f[0]||(f[0]=u=>t.name=u),label:"请输入样本名称","hide-details":"",clearable:"",onKeyup:L(i,["enter"]),"onClick:clear":i},null,8,["modelValue","onKeyup"])]),_:1}),e(F,{cols:"12",lg:"3",md:"4",sm:"6"},{default:a(()=>[e(_,null,{default:a(()=>[e(Q,{color:"primary",onClick:M},{default:a(()=>[r("上传样本")]),_:1})]),_:1})]),_:1}),e(F,{cols:"12"},{default:a(()=>[e(j,{onQuery:l,ref_key:"tableWithPagerRef",ref:p,infos:m},{default:a(()=>[e(h,{label:"样本名称",prop:"name","min-width":"200px","show-overflow-tooltip":""}),e(h,{label:"样本ID","min-width":"200px","show-overflow-tooltip":""},{default:a(({row:u})=>[O((k(),q("span",null,[r(T(u.uuid),1)])),[[N,u.uuid]])]),_:1}),e(h,{label:"样本数量",prop:"segmentCount","min-width":"110px"}),e(h,{label:"备注",prop:"remark","min-width":"200px","show-overflow-tooltip":""}),e(h,{label:"创建时间","min-width":"200px"},{default:a(({row:u})=>[r(T(Z(G).dateFormat(u.createdAt,"YYYY-MM-DD HH:mm:ss")),1)]),_:1}),e(h,{label:"操作人",prop:"creatorEmail","min-width":"220px"}),e(h,{label:"操作",width:"80px",fixed:"right"},{default:a(({row:u})=>[e(W,{buttons:B(u),onlyOne:""},null,8,["buttons"])]),_:1})]),_:1},8,["infos"])]),_:1})]),_:1})]),_:1}),e(ie,{ref_key:"refConfirmDelete",ref:c,onSubmit:o},{text:a(()=>[r(" 此操作将会"),xe,r("该样本数据集"),Ve,r(" 数据集ID："),n("span",we,T(x.id),1),ge,r(" 确定要继续吗？ ")]),_:1},512),e(ye,{ref_key:"createSamplePaneRef",ref:y,onSubmit:i},null,512)],64)}}});export{qe as default};
