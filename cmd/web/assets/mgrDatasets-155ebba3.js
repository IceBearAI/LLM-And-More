import{d as R,x as V,r as h,bj as Y,U as v,k,l as $,m as l,W as n,j as e,_ as r,$ as T,b9 as U,am as K,an as A,b8 as E,o as H,S as z,Z as q,bf as L,Q as O,n as Z,bg as G,F as J}from"./utils-380ae8e1.js";import{_ as X}from"./BaseBreadcrumb.vue_vue_type_style_index_0_lang-d3ad82eb.js";import{_ as ee}from"./UiParentCard.vue_vue_type_script_setup_true_lang-aa11bf62.js";import{C as te}from"./CustomUpload-defa2f75.js";import{_ as le}from"./Explain.vue_vue_type_style_index_0_lang-ed4ae5bc.js";import{ad as ae,d as oe,V as j,a4 as P,_ as se}from"./index-e3ddd1e6.js";import{V as re}from"./VTextarea-d585bc21.js";import{V as ne}from"./VForm-bacf8b83.js";import{_ as ie}from"./ConfirmByInput.vue_vue_type_style_index_0_lang-960c469c.js";import{V as de}from"./VRow-fc36e79d.js";import{V as F}from"./VCol-ac87f973.js";import"./Confirm-3cd730c8.js";const C=w=>(K("data-v-e14f00ba"),w=w(),A(),w),ue={class:"mx-auto mt-3",style:{width:"540px"}},me={class:"required"},pe=C(()=>n("label",{class:"required"},"样本名称",-1)),ce=C(()=>n("label",null,"分隔符",-1)),fe=C(()=>n("label",null,"分割值",-1)),_e=C(()=>n("label",null,"备注",-1)),be=C(()=>n("div",{class:"d-flex justify-center textPrimary"},[r(" 点击 "),n("a",{class:"link mx-1",href:"/assets/file/mgr-datasets.txt",download:"demo.txt"},"下载"),r(" 数据集模板 ")],-1)),he=R({__name:"CreateSamplePane",emits:["submit"],setup(w,{expose:S,emit:D}){const g=V({operateType:"add"}),t=V({file:null,name:"",splitType:"",splitMax:"",remark:""}),m=D,y=h(),p=h(),c=V({file:[o=>!!o||"请上传样本文件"],name:[o=>!!o||"请输入样本名称"],splitMax:[o=>Y.validNumberInput(o,0,2e3,"",!0)]}),x=o=>{t.file=o},I=()=>{t.file=null},B=async({valid:o,showLoading:a})=>{if(o){const i={url:"",method:""};g.operateType=="add"&&(i.url="/mgr/datasets/create",i.method="upload");const[s,M]=await U[i.method]({showLoading:a,showSuccess:!0,url:i.url,data:t});M&&(y.value.hide(),m("submit"))}};return S({show({title:o,operateType:a}){y.value.show({title:o,refForm:p}),g.operateType=a,g.operateType==="add"?(t.file=null,t.name="",t.splitType="",t.splitMax="",t.remark=""):console.log("edit")}}),(o,a)=>{const i=v("Pane");return k(),$(i,{ref_key:"refPane",ref:y,onSubmit:B},{default:l(()=>[n("div",ue,[e(ne,{ref_key:"refForm",ref:p,class:"my-form"},{default:l(()=>[e(ae,{rules:c.file,modelValue:t.file,"onUpdate:modelValue":a[0]||(a[0]=s=>t.file=s),"hide-details":"auto"},{prepend:l(()=>[n("label",me,[r("样本文件 "),e(le,null,{default:l(()=>[r("支持扩展名：.txt、.jsonl")]),_:1})])]),default:l(()=>[t.file?(k(),$(oe,{key:0,closable:"",color:"info","onClick:close":I},{default:l(()=>[r(T(t.file.name),1)]),_:1})):(k(),$(te,{key:1,"file-type":[".txt",".jsonl"],isSuffixValid:"",onBeforeUpload:x,"auto-upload":!1,"file-size":10},{trigger:l(()=>[e(j,{color:"info",variant:"outlined"},{default:l(()=>[r("选择文件")]),_:1})]),_:1},8,["file-type"]))]),_:1},8,["rules","modelValue"]),e(P,{type:"text",placeholder:"请输入样本名称","hide-details":"auto",clearable:"",rules:c.name,modelValue:t.name,"onUpdate:modelValue":a[1]||(a[1]=s=>t.name=s)},{prepend:l(()=>[pe]),_:1},8,["rules","modelValue"]),e(P,{type:"text",placeholder:"请输入分隔符","hide-details":"auto",clearable:"",modelValue:t.splitType,"onUpdate:modelValue":a[2]||(a[2]=s=>t.splitType=s)},{prepend:l(()=>[ce]),_:1},8,["modelValue"]),e(P,{type:"number",placeholder:"请输入分割值",rules:c.splitMax,"hide-details":"auto",modelValue:t.splitMax,"onUpdate:modelValue":a[3]||(a[3]=s=>t.splitMax=s),modelModifiers:{number:!0}},{prepend:l(()=>[fe]),_:1},8,["rules","modelValue"]),e(re,{modelValue:t.remark,"onUpdate:modelValue":a[4]||(a[4]=s=>t.remark=s),modelModifiers:{trim:!0},placeholder:"备注",clearable:""},{prepend:l(()=>[_e]),_:1},8,["modelValue"])]),_:1},512),be])]),_:1},512)}}});const ye=se(he,[["__scopeId","data-v-e14f00ba"]]),xe=n("span",{class:"text-primary font-weight-black"},"删除",-1),Ve=n("br",null,null,-1),we={class:"text-primary font-weight-black"},ge=n("br",null,null,-1),Ue=R({__name:"mgrDatasets",setup(w){const S=E(),D=h({title:"文本样本列表"}),g=h([{text:"样本库",disabled:!1,href:"#"},{text:"文本样本列表",disabled:!0,href:"#"}]),t=V({name:""}),m=V({list:[],total:0}),y=h(),p=h(),c=h(),x=V({id:""}),I=d=>{let f=[];return f.push({text:"删除",color:"error",click(){B(d)}}),f},B=d=>{x.id=d.uuid,c.value.show({width:"450px",confirmText:x.id})},o=async(d={})=>{const[f,_]=await U.delete({...d,showSuccess:!0,url:`/mgr/datasets/${x.id}`});_&&(c.value.hide(),s())},a=async(d={})=>{const[f,_]=await U.get({url:"/mgr/datasets/list",showLoading:p.value.el,data:{...t,...d}});_?(m.list=_.list||[],m.total=_.total):(m.list=[],m.total=0)},i=()=>{p.value.query({page:1})},s=()=>{p.value.query()},M=()=>{y.value.show({title:"上传样本",operateType:"add"})};return H(()=>{t.name=S.query.name,s()}),(d,f)=>{const _=v("ButtonsInForm"),b=v("el-table-column"),Q=v("ButtonsInTable"),W=v("TableWithPager"),N=z("copy");return k(),q(J,null,[e(X,{title:D.value.title,breadcrumbs:g.value},null,8,["title","breadcrumbs"]),e(ee,null,{default:l(()=>[e(de,null,{default:l(()=>[e(F,{cols:"12",lg:"3",md:"4",sm:"6"},{default:l(()=>[e(P,{modelValue:t.name,"onUpdate:modelValue":f[0]||(f[0]=u=>t.name=u),label:"请输入样本名称","hide-details":"",clearable:"",onKeyup:L(i,["enter"]),"onClick:clear":i},null,8,["modelValue","onKeyup"])]),_:1}),e(F,{cols:"12",lg:"3",md:"4",sm:"6"},{default:l(()=>[e(_,null,{default:l(()=>[e(j,{color:"primary",onClick:M},{default:l(()=>[r("上传样本")]),_:1})]),_:1})]),_:1}),e(F,{cols:"12"},{default:l(()=>[e(W,{onQuery:a,ref_key:"tableWithPagerRef",ref:p,infos:m},{default:l(()=>[e(b,{label:"样本名称",prop:"name","min-width":"200px","show-overflow-tooltip":""}),e(b,{label:"样本ID","min-width":"200px","show-overflow-tooltip":""},{default:l(({row:u})=>[O((k(),q("span",null,[r(T(u.uuid),1)])),[[N,u.uuid]])]),_:1}),e(b,{label:"样本数量",prop:"segmentCount","min-width":"110px"}),e(b,{label:"备注",prop:"remark","min-width":"200px","show-overflow-tooltip":""}),e(b,{label:"创建时间","min-width":"200px"},{default:l(({row:u})=>[r(T(Z(G).dateFormat(u.createdAt,"YYYY-MM-DD HH:mm:ss")),1)]),_:1}),e(b,{label:"操作人",prop:"creatorEmail","min-width":"220px"}),e(b,{label:"操作",width:"80px",fixed:"right"},{default:l(({row:u})=>[e(Q,{buttons:I(u),onlyOne:""},null,8,["buttons"])]),_:1})]),_:1},8,["infos"])]),_:1})]),_:1})]),_:1}),e(ie,{ref_key:"refConfirmDelete",ref:c,onSubmit:o},{text:l(()=>[r(" 此操作将会"),xe,r("该样本数据集"),Ve,r(" 数据集ID："),n("span",we,T(x.id),1),ge,r(" 确定要继续吗？ ")]),_:1},512),e(ye,{ref_key:"createSamplePaneRef",ref:y,onSubmit:i},null,512)],64)}}});export{Ue as default};
