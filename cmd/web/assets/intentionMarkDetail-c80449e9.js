import{_ as ne}from"./NavBack.vue_vue_type_script_setup_true_lang-bc31ea81.js";import{d as S,k as Q,l as H,m as t,j as e,_ as m,$ as v,n as Y,bg as A,am as X,an as ee,W as _,x as $,r as x,U as V,b9 as F,b8 as L,o as W,Z as K,bf as j,F as E,bT as le}from"./utils-d360fd38.js";import{_ as Z}from"./UiParentCard.vue_vue_type_script_setup_true_lang-f0de3c2a.js";import{ad as B,_ as te,a4 as N,V as oe}from"./index-8b7fa986.js";import{V as I}from"./VCol-dc51774a.js";import{V as R}from"./VRow-92b162a6.js";import{V as U}from"./VTextarea-cca1525d.js";import{V as se}from"./VForm-1f16fcb0.js";import{_ as re}from"./ConfirmByClick.vue_vue_type_style_index_0_lang-9ff2c807.js";import{C as ie}from"./CustomUpload-45058c47.js";import{V as de,a as G,b as ue,c as J}from"./VWindowItem-1455462d.js";import"./Confirm-dc38596b.js";const M=c=>(X("data-v-8e457af5"),c=c(),ee(),c),ce=M(()=>_("label",null,"创建人",-1)),pe=M(()=>_("label",null,"创建时间",-1)),me=M(()=>_("label",null,"更新时间",-1)),_e=M(()=>_("label",null,"备注",-1)),fe=S({__name:"DetailBaseInfo",props:{info:{default:()=>({})}},setup(c){const b=c;return(f,u)=>(Q(),H(R,{class:"my-form waterfall"},{default:t(()=>[e(I,{xs:"12",sm:"6",md:"4",lg:"3"},{default:t(()=>[e(B,{"hide-details":""},{prepend:t(()=>[ce]),default:t(()=>[m(" "+v(b.info.operator),1)]),_:1})]),_:1}),e(I,{xs:"12",sm:"6",md:"4",lg:"3"},{default:t(()=>[e(B,{"hide-details":""},{prepend:t(()=>[pe]),default:t(()=>[m(" "+v(Y(A).dateFormat(b.info.createdAt,"YYYY-MM-DD HH:mm:ss")),1)]),_:1})]),_:1}),e(I,{xs:"12",sm:"6",md:"4",lg:"3"},{default:t(()=>[e(B,{"hide-details":""},{prepend:t(()=>[me]),default:t(()=>[m(" "+v(Y(A).dateFormat(b.info.updatedAt,"YYYY-MM-DD HH:mm:ss")),1)]),_:1})]),_:1}),e(I,{xs:"12",sm:"6",md:"4",lg:"3"},{default:t(()=>[e(B,{"hide-details":""},{prepend:t(()=>[_e]),default:t(()=>[m(" "+v(b.info.remark),1)]),_:1})]),_:1})]),_:1}))}});const he=te(fe,[["__scopeId","data-v-8e457af5"]]),z=c=>(X("data-v-a2a40ce9"),c=c(),ee(),c),be={class:"mx-auto mt-3",style:{width:"540px"}},we=z(()=>_("label",{class:"required"},"标准问",-1)),ye=z(()=>_("label",{class:"required"},"回答",-1)),ge=z(()=>_("label",{class:"required"},"意图",-1)),ve=S({__name:"CreateQAPane",props:{intentId:{default:""}},emits:["submit"],setup(c,{expose:b,emit:f}){const u=c,n=f,r=$({operateType:"add"}),o=$({documentId:"",question:"",output:"",intent:""}),s=x(),p=x(),k=$({question:[i=>!!i||"请输入标准问"],output:[i=>!!i||"请输入回答"],intent:[i=>!!i||"请输入意图"]}),q=async({valid:i,showLoading:d})=>{if(i){const a={url:"",method:""};r.operateType=="add"?(a.url=`/intent/${u.intentId}/document/create`,a.method="post"):(a.url=`/api/intent/${u.intentId}/document/${o.documentId}/update`,a.method="put");const[y,h]=await F[a.method]({showLoading:d,showSuccess:!0,url:a.url,data:o});h&&(s.value.hide(),n("submit"))}};return b({show({title:i,operateType:d,infos:a}){s.value.show({title:i,refForm:p}),r.operateType=d,r.operateType==="add"?(o.question="",o.output="",o.intent=""):(o.question=a.question,o.output=a.output,o.intent=a.intent,o.documentId=a.documentId)}}),(i,d)=>{const a=V("Pane");return Q(),H(a,{ref_key:"refPane",ref:s,onSubmit:q},{default:t(()=>[_("div",be,[e(se,{ref_key:"refForm",ref:p,class:"my-form"},{default:t(()=>[e(U,{modelValue:o.question,"onUpdate:modelValue":d[0]||(d[0]=y=>o.question=y),rules:k.question,placeholder:"用户问","hide-details":"auto",rows:3},{prepend:t(()=>[we]),_:1},8,["modelValue","rules"]),e(U,{modelValue:o.output,"onUpdate:modelValue":d[1]||(d[1]=y=>o.output=y),rules:k.output,placeholder:"客服回答","hide-details":"auto",rows:3},{prepend:t(()=>[ye]),_:1},8,["modelValue","rules"]),e(U,{modelValue:o.intent,"onUpdate:modelValue":d[2]||(d[2]=y=>o.intent=y),rules:k.intent,placeholder:"意图","hide-details":"auto",rows:3},{prepend:t(()=>[ge]),_:1},8,["modelValue","rules"])]),_:1},512)])]),_:1},512)}}});const Ie=te(ve,[["__scopeId","data-v-a2a40ce9"]]),xe=["onClick"],ke=["onClick"],Ve=_("span",{class:"font-weight-bold"},"这是进行一项操作时必须了解的重要信息",-1),$e=_("br",null,null,-1),Ce={class:"text-primary"},De=_("br",null,null,-1),qe=S({__name:"QAList",setup(c){const b=L(),{intentId:f}=b.query,u=$({keyword:""}),n=$({list:[],total:0}),r=x(),o=x(),s=x(),p=$({documentId:"",question:""}),k=l=>{let w=[];return w.push({text:"编辑",color:"info",click(){P(l)}}),w.push({text:"废弃",color:"error",click(){q(l)}}),w},q=l=>{p.documentId=l.documentId,p.question=l.question,s.value.show({width:"450px"})},i=async(l={})=>{const[w,T]=await F.delete({...l,showSuccess:!0,url:`/intent/${f}/document/${p.documentId}/delete`});T&&(s.value.hide(),y())},d=async(l={})=>{const[w,T]=await F.get({url:`/intent/${f}/document/list`,showLoading:o.value.el,data:{...u,...l}});T?(n.list=T.list||[],n.total=T.total):(n.list=[],n.total=0)},a=()=>{o.value.query({page:1})},y=()=>{o.value.query()},h=()=>{r.value.show({title:"添加问答",operateType:"add"})},P=l=>{r.value.show({title:"编辑问答",infos:l,operateType:"edit"})};return W(()=>{y()}),(l,w)=>{const T=V("ButtonsInForm"),C=V("el-table-column"),D=V("ButtonsInTable"),O=V("TableWithPager");return Q(),K(E,null,[e(R,null,{default:t(()=>[e(I,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[e(N,{modelValue:u.keyword,"onUpdate:modelValue":w[0]||(w[0]=g=>u.keyword=g),label:"请输入关键字","hide-details":"",clearable:"",onKeyup:j(a,["enter"]),"onClick:clear":a},null,8,["modelValue","onKeyup"])]),_:1}),e(I,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[e(T,null,{default:t(()=>[e(oe,{color:"primary",onClick:h},{default:t(()=>[m("添加问答")]),_:1})]),_:1})]),_:1}),e(I,{cols:"12"},{default:t(()=>[e(O,{onQuery:d,ref_key:"tableWithPagerRef",ref:o,infos:n},{default:t(()=>[e(C,{label:"ID","min-width":"240px"},{default:t(({row:g})=>[_("a",{href:"javascript: void(0)",class:"link",onClick:ae=>P(g)},v(g.documentId),9,xe)]),_:1}),e(C,{label:"标准问法","min-width":"200px","show-overflow-tooltip":""},{default:t(({row:g})=>[_("a",{href:"javascript: void(0)",class:"link",onClick:ae=>P(g)},v(g.question),9,ke)]),_:1}),e(C,{label:"答案",prop:"output","min-width":"200px","show-overflow-tooltip":""}),e(C,{label:"意图",prop:"intent","min-width":"200px","show-overflow-tooltip":""}),e(C,{label:"更新时间","min-width":"200px"},{default:t(({row:g})=>[m(v(Y(A).dateFormat(g.updatedAt,"YYYY-MM-DD HH:mm:ss")),1)]),_:1}),e(C,{label:"添加时间","min-width":"200px"},{default:t(({row:g})=>[m(v(Y(A).dateFormat(g.createdAt,"YYYY-MM-DD HH:mm:ss")),1)]),_:1}),e(C,{label:"操作人",prop:"operator","min-width":"220px"}),e(C,{label:"操作",width:"100px",fixed:"right"},{default:t(({row:g})=>[e(D,{buttons:k(g)},null,8,["buttons"])]),_:1})]),_:1},8,["infos"])]),_:1})]),_:1}),e(re,{ref_key:"refConfirmDelete",ref:s,onSubmit:i},{text:t(()=>[Ve,$e,m(" 您将要废弃"),_("span",Ce,v(p.question),1),De,m(" 确定要继续吗？ ")]),_:1},512),e(Ie,{ref_key:"createQAPaneRef",ref:r,intentId:Y(f),onSubmit:a},null,8,["intentId"])],64)}}}),Pe=S({__name:"SelectIntentionList",props:{intentId:{default:""}},emits:["onSelect"],setup(c,{emit:b}){const f=c,u=b,n=$({keyword:""}),r=$({list:[],total:0}),o=x(),s=x(),p=async(i={})=>{const[d,a]=await F.get({url:`/intent/${f.intentId}/document/list`,showLoading:o.value.el,data:{...n,...i}});a?(r.list=a.list||[],r.total=a.total):(r.list=[],r.total=0)},k=()=>{o.value.query({page:1})},q=i=>{u("onSelect",i)};return W(()=>{k()}),(i,d)=>{const a=V("el-table-column"),y=V("TableWithPager");return Q(),H(R,{class:"my-0",ref_key:"contentRef",ref:s},{default:t(()=>[e(I,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[e(N,{modelValue:n.keyword,"onUpdate:modelValue":d[0]||(d[0]=h=>n.keyword=h),label:"请输入关键字","hide-details":"",clearable:"",onKeyup:j(k,["enter"]),"onClick:clear":k},null,8,["modelValue","onKeyup"])]),_:1}),e(I,{cols:"12"},{default:t(()=>[e(y,{"row-class-name":"cursor-pointer",onRowClick:q,onQuery:p,ref_key:"tableWithPagerRef",ref:o,infos:r,height:"400px"},{default:t(()=>[e(a,{label:"标准问法",prop:"question","show-overflow-tooltip":""}),e(a,{label:"答案",prop:"output","show-overflow-tooltip":""}),e(a,{label:"意图",prop:"intent","show-overflow-tooltip":""})]),_:1},8,["infos"])]),_:1})]),_:1},512)}}}),Te={class:"d-flex align-center"},Ye={class:"line1 flex-1"},Fe=S({__name:"MarkList",setup(c){const b=L(),{intentId:f}=b.query,u=$({keyword:""}),n=$({list:[],total:0}),r=x(),o=x(),s=x(!1),p=$({annotationId:""}),k=async(h={})=>{const[P,l]=await F.get({url:`/intent/${f}/annotation/list`,showLoading:r.value.el,data:{...u,...h}});l?(n.list=l.list||[],n.total=l.total):(n.list=[],n.total=0)},q=()=>{r.value.query({page:1})},i=()=>{r.value.query()},d=h=>{p.annotationId=h,o.value.show({showActions:!1})},a=async h=>{const[P,l]=await F.post({showLoading:o.value.getContentEl(),showSuccess:!0,url:`/intent/${f}/annotation/${p.annotationId}/mark`,data:{documentId:h.documentId}});l&&(o.value.hide(),i())},y=async({res:h})=>{if(h){s.value=!0;const[P,l]=await F.post({showSuccess:!0,url:`/intent/${f}/annotation/create`,data:{fileId:h.fileId}});l&&q(),s.value=!1}};return W(()=>{i()}),(h,P)=>{const l=V("ButtonsInForm"),w=V("el-table-column"),T=V("TableWithPager"),C=V("Dialog");return Q(),K(E,null,[e(R,null,{default:t(()=>[e(I,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[e(N,{modelValue:u.keyword,"onUpdate:modelValue":P[0]||(P[0]=D=>u.keyword=D),label:"请输入关键字","hide-details":"",clearable:"",onKeyup:j(q,["enter"]),"onClick:clear":q},null,8,["modelValue","onKeyup"])]),_:1}),e(I,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[e(l,null,{default:t(()=>[e(ie,{"file-type":["text/csv"],onAfterUpload:y},{trigger:t(({loading:D})=>[e(oe,{loading:D||s.value,color:"primary"},{default:t(()=>[m("导入")]),_:2},1032,["loading"])]),_:1})]),_:1})]),_:1}),e(I,{cols:"12"},{default:t(()=>[e(T,{onQuery:k,ref_key:"tableWithPagerRef",ref:r,infos:n},{default:t(()=>[e(w,{label:"问题",prop:"question","min-width":"200px","show-overflow-tooltip":""}),e(w,{label:"答案",prop:"output","min-width":"200px","show-overflow-tooltip":""}),e(w,{label:"意图","min-width":"200px"},{default:t(({row:D})=>[_("div",Te,[_("div",Ye,v(D.intent),1),e(Y(le),{onClick:O=>d(D.annotationId),"stroke-width":"1.5",size:20,class:"text-primary cursor-pointer"},null,8,["onClick"])])]),_:1}),e(w,{label:"更新时间","min-width":"200px"},{default:t(({row:D})=>[m(v(Y(A).dateFormat(D.updatedAt,"YYYY-MM-DD HH:mm:ss")),1)]),_:1}),e(w,{label:"操作人",prop:"operator","min-width":"220px"})]),_:1},8,["infos"])]),_:1})]),_:1}),e(C,{ref_key:"selectIntentionRef",ref:o,persistent:"","max-width":"1200px","retain-focus":!1},{title:t(()=>[m(" 选择意图 ")]),default:t(()=>[e(Pe,{intentId:Y(f),onOnSelect:a},null,8,["intentId"])]),_:1},512)],64)}}}),Ee=S({__name:"intentionMarkDetail",setup(c){const b=L(),{intentId:f}=b.query,u=x({}),n=x(""),r=async()=>{let[o,s]=await F.get({showLoading:!0,url:`/intent/${f}`});s&&(u.value=s)};return W(()=>{r()}),(o,s)=>(Q(),K(E,null,[e(ne,{backUrl:"/sample-library/intention-mark/list"},{default:t(()=>[m("意图模型标注详情")]),_:1}),e(Z,{class:"mt-4"},{header:t(()=>[m(" 名称："+v(u.value.name),1)]),default:t(()=>[e(he,{info:u.value},null,8,["info"])]),_:1}),e(Z,{class:"mt-5"},{header:t(()=>[e(de,{modelValue:n.value,"onUpdate:modelValue":s[0]||(s[0]=p=>n.value=p),"align-tabs":"start",color:"primary"},{default:t(()=>[e(G,{value:1},{default:t(()=>[m("问答")]),_:1}),e(G,{value:2},{default:t(()=>[m("标注")]),_:1})]),_:1},8,["modelValue"])]),default:t(()=>[e(ue,{modelValue:n.value,"onUpdate:modelValue":s[1]||(s[1]=p=>n.value=p)},{default:t(()=>[e(J,{class:"pt-2",value:1},{default:t(()=>[e(qe)]),_:1}),e(J,{class:"pt-2",value:2},{default:t(()=>[e(Fe)]),_:1})]),_:1},8,["modelValue"])]),_:1})],64))}});export{Ee as default};
